<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Daily Deen | Prayer Times, Quran, Qibla & Serenity</title>
    <meta name="title" content="Daily Deen | Your Digital Islamic Companion">
    <meta name="description" content="A privacy-focused Islamic dashboard featuring accurate Prayer Times, Al-Quran reading, Qibla direction, daily Duas, and a Serenity station for focus and sleep.">
    <meta name="keywords" content="Prayer Times, Quran, Qibla Finder, Islamic App, Daily Dua, Ramadan Tracker, Muslim Dashboard">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#0f172a">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-website-url.com/">
    <meta property="og:title" content="Daily Deen | Your Digital Sanctuary">
    <meta property="og:description" content="Accurate Prayer Times, Quran, and Mindfulness for the modern Muslim. Ad-free and privacy-focused.">
    <meta property="og:image" content="https://your-website-url.com/preview-image.jpg">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Daily Deen">
    <meta property="twitter:description" content="Accurate Prayer Times, Quran, and Mindfulness for the modern Muslim.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='gold' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23fbbf24'/%3E%3Cstop offset='100%25' stop-color='%23d97706'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='%2309090b'/%3E%3Cpath d='M50,15 C28,15 10,33 10,55 C10,77 28,95 50,95 C54.5,95 59,94 63,93 C55,91 48,87 43,81 C38,75 36,68 36,60 C36,48 43,37 53,31 C52,31 51,31 50,31 C36.5,31 25.5,42 25.5,55.5 C25.5,69 36.5,80 50,80 C55,80 59,79 63,76 C65,79 68,82 71,84 C65,88 58,90 50,90 C31,90 15,75 15,55 C15,36 31,20 50,20 C58,20 65,22 71,26 C66,29 62,34 60,39 C65,37 71,36 77,36 C79,36 81,36 83,36 C85,30 84,22 80,16 C72,21 62,24 52,24 L50,15 Z' fill='url(%23gold)'/%3E%3C/svg%3E">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
<script src="https://unpkg.com/lenis@1.0.45/dist/lenis.min.js"></script>
<script src="https://unpkg.com/split-type"></script>

<style>
    /* =========================================
       1. THEME ENGINE (CSS VARIABLES)
       ========================================= */
    :root {
    /* Refined Dark Mode */
    --bg-body: #09090b; /* Darker, richer black */
    --bg-card: rgba(24, 24, 27, 0.6); /* Zinc tone */
    --bg-nav: rgba(9, 9, 11, 0.85);
    --border: rgba(255, 255, 255, 0.1);
    
    --text-primary: #ffffff;
    --text-secondary: #a1a1aa;
    
    /* Elegant Gold */
    --brand-gold: #fbbf24; 
    --brand-gold-glow: rgba(251, 191, 36, 0.25);
    
    /* Serenity Green */
    --brand-green: #34d399;
    --brand-green-glow: rgba(52, 211, 153, 0.2);
    
    --shadow-card: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
}
    /* RAMADAN THEME OVERRIDES */
    body.ramadan-mode {
        --bg-body: #2e1065; /* Deep Purple */
        --bg-card: rgba(88, 28, 135, 0.5);
        --bg-nav: rgba(19, 7, 36, 0.95);
        --brand-gold: #fbbf24;
        --brand-green: #d8b4fe; /* Lavender Accent */
        --text-secondary: #e9d5ff;
        background-image: radial-gradient(at 50% 0%, rgba(192, 132, 252, 0.3) 0, transparent 50%);
    }
    
    /* Toggle Button Style */
    /* UPDATED BUTTON STYLE - Removed 'absolute' so it fits in the widget */
    .ramadan-btn {
        background: var(--bg-card); 
        border: 1px solid var(--brand-gold);
        color: var(--brand-gold); 
        
        /* Layout & Spacing */
        padding: 6px 12px;
        border-radius: 20px;
        cursor: pointer; 
        display: flex; 
        align-items: center; 
        gap: 6px;
        margin-bottom: 4px; /* Pushes the text down slightly */
        
        /* Font Settings */
        font-weight: 600;
        font-size: 0.8rem;
        transition: 0.3s;
    }
    
    .ramadan-btn:hover { background: rgba(251, 191, 36, 0.1); }
    .ramadan-btn.active { background: var(--brand-gold); color: #000; }

    /* --- VISIBLE RAMADAN BADGE --- */
.ramadan-widget {
    position: absolute; top: 20px; right: 20px; z-index: 50;
    display: flex; flex-direction: column; align-items: flex-end;
    background: rgba(0, 0, 0, 0.6); /* Dark Glass */
    backdrop-filter: blur(10px);
    padding: 10px 15px;
    border-radius: 16px;
    border: 1px solid var(--brand-gold);
    box-shadow: 0 0 15px var(--brand-gold-glow);
    transition: transform 0.3s;
}
.ramadan-widget:hover { transform: scale(1.02); }
.ramadan-btn.active { background: var(--brand-gold); color: #000;}

.ramadan-days-left {
    font-size: 0.9rem; /* Larger text */
    color: var(--brand-gold); /* Gold text */
    font-weight: 700;
    margin-right: 0;
    margin-top: 5px;
    text-shadow: 0 0 10px rgba(251, 191, 36, 0.4);
}

    /* LIGHT MODE OVERRIDES */
    body.light-theme {
        --bg-body: #f1f5f9;
        --bg-card: rgba(255, 255, 255, 0.8);
        --bg-nav: rgba(255, 255, 255, 0.85);
        --border: rgba(0, 0, 0, 0.06);
        
        --text-primary: #1e293b;
        --text-secondary: #64748b;
        
        --brand-gold: #b45309; /* Darker Gold for contrast */
        --brand-gold-glow: rgba(180, 83, 9, 0.15);
        
        --brand-green: #059669; /* Darker Green for contrast */
        --brand-green-glow: rgba(5, 150, 105, 0.15);
        
        --shadow-card: 0 10px 40px -10px rgba(0,0,0,0.08);
        --input-bg: #fff;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; transition: background-color 0.4s ease, color 0.3s ease, border-color 0.3s ease; }

   /* --- 100x ATMOSPHERE ENGINE --- */

/* --- NEW ANIMATED ATMOSPHERE ENGINE --- */

/* 1. Define the Color Palette (Variables) */
:root {
    /* Default (Night) - Dark Blue/Black */
    --bg-color-1: #0f172a;
    --bg-color-2: #1e1b4b;
    --bg-color-3: #000000;
}

/* --- VIBRANT AURORA ENGINE --- */
body {
    /* Brighter, deeper colors for visibility */
    background: linear-gradient(300deg, #0f172a, #312e81, #0f172a, #1e3a8a);
    background-size: 240% 240%;
    animation: gradient-animation 10s ease infinite; /* Faster speed */
    color: var(--text-primary);
    font-family: 'Outfit', sans-serif;
    min-height: 100vh;
    display: flex; flex-direction: column;
    overflow-x: hidden;
    transition: --bg-color-1 3s; 
}

@keyframes gradient-animation {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Time-Based Overrides (More Distinct) */
body.time-fajr { background: linear-gradient(300deg, #0f172a, #0d9488, #0f172a); } /* Teal glow */
body.time-day { background: linear-gradient(300deg, #0369a1, #38bdf8, #0284c7); } /* Sky blue motion */
body.time-maghrib { background: linear-gradient(300deg, #4c0519, #be123c, #7c2d12); } /* Red/Sunset motion */
body.time-night { background: linear-gradient(300deg, #0f172a, #312e81, #000000); } /* Deep Indigo */

/* NIGHT: Uses the default defined in :root */

/* The Grain Texture (Kept, but refined) */
body::before {
    content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none; z-index: -1;
}



/* This must be SEPARATE, not inside body {} */
body::before {
    content: "";
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: -1;
    opacity: 0.4;
}

    /* =========================================
       2. NAVIGATION BAR
       ========================================= */
    nav {
        position: sticky; top: 0; z-index: 100;
        padding: 15px 5%;
        background: var(--bg-nav);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border-bottom: 1px solid var(--border);
        display: flex; justify-content: space-between; align-items: center;
    }

    .brand {
        font-size: 1.5rem; font-weight: 700;
        display: flex; align-items: center; gap: 10px;
        color: var(--text-primary);
        letter-spacing: -0.5px;
    }
    .brand i { color: var(--brand-gold); filter: drop-shadow(0 0 8px var(--brand-gold-glow)); }

    .nav-menu { display: flex; gap: 5px; background: var(--bg-card); padding: 5px; border-radius: 50px; border: 1px solid var(--border); }
    
    .nav-btn {
        background: transparent; border: none;
        padding: 8px 20px; border-radius: 40px;
        color: var(--text-secondary); font-weight: 500; font-family: inherit;
        cursor: pointer; transition: 0.3s;
    }
    .nav-btn:hover { color: var(--text-primary); }
    .nav-btn.active { background: var(--brand-gold); color: #fff; box-shadow: 0 2px 10px var(--brand-gold-glow); }
    /* In light mode, keep active text white but text darker */
    body.light-theme .nav-btn.active { color: #fff; }

    .theme-toggle {
        background: var(--bg-card); border: 1px solid var(--border);
        color: var(--text-primary); width: 40px; height: 40px; border-radius: 50%;
        display: flex; align-items: center; justify-content: center; cursor: pointer;
        transition: 0.3s; font-size: 1.1rem;
    }
    .theme-toggle:hover { transform: rotate(45deg); border-color: var(--brand-gold); color: var(--brand-gold); }

    /* =========================================
       3. LAYOUT & CARDS
       ========================================= */
    .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; width: 100%; flex: 1; position: relative; }

    /* Hide/Show Views */
    .view-section { display: none; animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
    .view-section.active { display: block; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* Hero */
    .hero { text-align: center; margin-bottom: 50px; }
   /* --- FIXED TEXT STYLES (Supports Firefox & Chrome) --- */
.greeting {
    font-size: 3rem;
    font-weight: 700;
    
    /* 1. The Gradient Color */
    background-image: linear-gradient(135deg, var(--text-primary) 30%, var(--text-secondary));
    
    /* 2. THE FIX: Standard Syntax for Firefox */
    background-clip: text; 
    
    /* 3. Webkit Syntax for Chrome/Mobile */
    -webkit-background-clip: text;
    
    /* 4. Make text transparent so background shows through */
    color: transparent;
    -webkit-text-fill-color: transparent;
    
    letter-spacing: -1px;
    margin-bottom: 10px;
    display: inline-block;
}

.date-badge {
    display: inline-block;
    padding: 6px 16px;
    border-radius: 20px;
    background: rgba(251, 191, 36, 0.1);
    color: var(--brand-gold);
    font-size: 0.9rem;
    font-weight: 600;
    border: 1px solid var(--brand-gold-glow);
}
    /* Card Grid */
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; }

    .card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 24px;
        padding: 30px;
        backdrop-filter: blur(12px);
        box-shadow: var(--shadow-card);
        position: relative; overflow: hidden;
        transition: transform 0.3s, box-shadow 0.3s;
        display: flex; flex-direction: column;
    }
    
    .card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: linear-gradient(90deg, var(--brand-gold), transparent); opacity: 0; transition: 0.3s; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px -10px var(--brand-gold-glow); }
    .card:hover::before { opacity: 1; }

    .card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 25px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; }
    .card-header i { font-size: 1.2rem; color: var(--brand-gold); }

    /* =========================================
       4. COMPONENT STYLES
       ========================================= */
    /* Prayer Times */
    .prayer-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border); font-size: 1rem; }
    .prayer-row:last-child { border: none; }
    .prayer-row.next-prayer { color: var(--brand-gold); font-weight: 700; transform: scale(1.02); padding-left: 10px; border-left: 3px solid var(--brand-gold); border-bottom-color: transparent; }

    /* Input Fields */
    .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
    .styled-input { flex: 1; background: var(--input-bg); border: 1px solid var(--border); color: var(--text-primary); padding: 12px 15px; border-radius: 12px; font-family: inherit; }
    .styled-input:focus { outline: none; border-color: var(--brand-gold); box-shadow: 0 0 0 3px var(--brand-gold-glow); }

    /* Quran Reader */
    .surah-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
    .surah-item { background: var(--bg-card); padding: 15px; border-radius: 12px; border: 1px solid var(--border); cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; }
    .surah-item:hover { border-color: var(--brand-green); background: rgba(16, 185, 129, 0.05); }
    .surah-num { background: var(--brand-gold); color: #fff; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.8rem; font-weight: bold; }
    
    .ayah-box { padding: 30px 0; border-bottom: 1px solid var(--border); }
    .ayah-arabic { font-family: 'Amiri', serif; font-size: 2.2rem; text-align: right; margin-bottom: 15px; line-height: 2.2; color: var(--text-primary); }
    .ayah-trans { color: var(--text-secondary); font-size: 1.1rem; line-height: 1.6; }

    /* Qibla Compass */
    .compass-wrapper { position: relative; width: 250px; height: 250px; margin: 0 auto; border: 8px solid var(--border); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 50px var(--brand-gold-glow); }
    .kaaba-pointer { font-size: 4rem; color: var(--brand-gold); transition: transform 1s ease-out; }
    .compass-deg { position: absolute; bottom: -50px; font-size: 2rem; font-weight: 700; color: var(--text-primary); }

    /* Footer */
    footer { text-align: center; padding: 40px; border-top: 1px solid var(--border); color: var(--text-secondary); font-size: 0.9rem; }
    .basmala { font-family: 'Amiri', serif; font-size: 1.4rem; color: var(--brand-gold); display: block; margin-bottom: 10px; }

    /* Utils */
    .btn-action { background: var(--brand-green); color: #fff; border: none; padding: 12px; width: 100%; border-radius: 12px; font-weight: 600; cursor: pointer; margin-top: auto; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .btn-action:hover { box-shadow: 0 10px 20px -5px var(--brand-green-glow); transform: translateY(-2px); }
    .spinner { width: 24px; height: 24px; border: 3px solid var(--border); border-top-color: var(--brand-gold); border-radius: 50%; animation: spin 1s infinite linear; margin: 20px auto; }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* Mobile */
    @media (max-width: 768px) {
        nav { flex-direction: column; gap: 15px; }
        .nav-menu { width: 100%; justify-content: space-between; }
        .nav-btn { padding: 8px 15px; font-size: 0.85rem; }
        .greeting { font-size: 2rem; }
    }
    /* --- NEW HERO STYLES --- */
    .hero-content {
        padding: 20px 0;
    }
    
    .hero-arabic {
    font-family: 'Amiri', serif;
    font-size: 3.5rem;
    font-weight: 700;
    
    /* 1. The Gradient */
    background-image: linear-gradient(135deg, var(--brand-gold) 20%, #fff 80%);
    
    /* 2. THE FIX: Standard Syntax for Firefox */
    background-clip: text; 
    
    /* 3. Webkit Syntax for Chrome/Mobile */
    -webkit-background-clip: text;
    
    /* 4. Make text transparent */
    color: transparent;
    -webkit-text-fill-color: transparent;
    
    /* 5. Essential layout fix */
    display: inline-block; 
    line-height: 1.2;
    
    /* Glow Effect */
    filter: drop-shadow(0 0 15px var(--brand-gold-glow));
    animation: heroFade 1s ease-out;
}
    .hero-dua {
        font-size: 1.2rem;
        color: var(--text-primary);
        font-weight: 300;
        margin-top: 5px;
        opacity: 0;
        /* Animation Delay so it appears 2nd */
        animation: slideUpFade 0.8s ease-out forwards 0.3s; 
    }

    .hero-tagline {
        font-size: 0.85rem;
        color: var(--brand-gold);
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-top: 10px;
        margin-bottom: 25px;
        opacity: 0;
        /* Animation Delay so it appears 3rd */
        animation: slideUpFade 0.8s ease-out forwards 0.6s; 
        font-weight: 600;
    }

    @keyframes heroFade { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    @keyframes slideUpFade { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* --- SERENITY TAB STYLES (New) --- */
    #serenity {
        /* Deep Peaceful Gradient */
        background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
        border-radius: 24px;
        padding: 40px 20px;
        min-height: 85vh;
        color: #fff;
        text-align: center;
        box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5);
    }

    .serenity-header { margin-bottom: 40px; }
    
    .serenity-title {
        font-family: 'Amiri', serif;
        font-size: 3.5rem;
        color: #a8d8b9; /* Soft Sage Green */
        text-shadow: 0 0 25px rgba(168, 216, 185, 0.2);
        margin-bottom: 10px;
    }
    
    .serenity-caption {
        font-size: 1.1rem;
        color: #dbece5;
        font-weight: 300;
        opacity: 0.9;
        letter-spacing: 0.5px;
    }

    /* Mood Cards Grid */
    .mood-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 20px;
        max-width: 800px;
        margin: 0 auto 40px auto;
    }

    .mood-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 25px 15px;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .mood-card:hover, .mood-card.active {
        background: rgba(168, 216, 185, 0.15);
        border-color: #a8d8b9;
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }

    .mood-icon { font-size: 2.5rem; display: block; margin-bottom: 15px; }
    .mood-name { font-weight: 600; font-size: 0.95rem; letter-spacing: 1px; color: #fff; }

    /* Player Box */
    .player-container {
        background: rgba(0, 0, 0, 0.25);
        border-radius: 24px;
        padding: 25px;
        max-width: 750px;
        margin: 0 auto;
        border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .iframe-container {
        position: relative;
        padding-bottom: 56.25%; /* 16:9 Ratio */
        height: 0;
        overflow: hidden;
        border-radius: 16px;
        background: #000;
        box-shadow: 0 20px 50px rgba(0,0,0,0.4);
    }
    
    .iframe-container iframe {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        border: none;
    }

    .now-playing {
        font-family: 'Outfit', sans-serif;
        font-size: 1.2rem;
        color: #a8d8b9;
        margin-bottom: 15px;
        font-weight: 500;
    }
    
    #serenity-clock {
        font-weight: 700;
        color: #fff;
        margin-left: 8px;
    }
    /* --- NEW FEATURES CSS --- */

/* 1. Accessibility Font Sizing */
html.font-large { font-size: 19px; }
html.font-extra { font-size: 22px; }

/* 2. Heart Check-In */
.mood-selector { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
.mood-selector::-webkit-scrollbar { display: none; }
.mood-btn { background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: var(--text-primary); padding: 10px 15px; border-radius: 12px; white-space: nowrap; cursor: pointer; transition: 0.3s; font-size: 0.9rem; }
.mood-btn:hover { background: var(--brand-green); color: #000; transform: translateY(-2px); }

/* 3. Daily Checklist */
.checklist-container { display: flex; flex-direction: column; gap: 12px; }
.check-item { display: flex; align-items: center; gap: 12px; cursor: pointer; background: rgba(255,255,255,0.03); padding: 10px; border-radius: 8px; transition: 0.2s; }
.check-item:hover { background: rgba(255,255,255,0.08); }
.check-item.checked { opacity: 0.5; text-decoration: line-through; }
.custom-checkbox { width: 20px; height: 20px; border: 2px solid var(--brand-gold); border-radius: 4px; display: flex; align-items: center; justify-content: center; }
.check-item.checked .custom-checkbox { background: var(--brand-gold); }
.check-item.checked .custom-checkbox::after { content: '✓'; color: #000; font-weight: bold; font-size: 0.8rem; }

/* 4. The "Nur" Footer */
.footer-wave { position: relative; width: 100%; overflow: hidden; line-height: 0; margin-top: 50px; z-index: 2; }
.footer-wave svg { display: block; width: calc(137% + 1.3px); height: 60px; }
.footer-wave .shape-fill { fill: #0f172a; }

#spiritual-footer { background-color: #0f172a; box-shadow: 0 -10px 50px rgba(251, 191, 36, 0.15); padding-bottom: 30px; color: #fff; position: relative; z-index: 10; }

.sadaqah-wrapper { display: flex; justify-content: center; transform: translateY(-50%); }
.sadaqah-badge { background: #000; border: 2px solid var(--brand-gold); color: var(--brand-gold); padding: 12px 30px; border-radius: 50px; font-weight: 800; font-size: 0.9rem; letter-spacing: 1px; box-shadow: 0 0 25px rgba(251, 191, 36, 0.4); animation: goldPulse 3s infinite; text-transform: uppercase; font-family: 'Outfit', sans-serif; }
@keyframes goldPulse { 0% { box-shadow: 0 0 25px rgba(251, 191, 36, 0.4); transform: scale(1); } 50% { box-shadow: 0 0 40px rgba(251, 191, 36, 0.7); transform: scale(1.05); } 100% { box-shadow: 0 0 25px rgba(251, 191, 36, 0.4); transform: scale(1); } }

.ticker-container { background: rgba(255, 255, 255, 0.03); border-top: 1px solid rgba(255, 255, 255, 0.05); border-bottom: 1px solid rgba(255, 255, 255, 0.05); padding: 15px 0; margin-bottom: 30px; overflow: hidden; white-space: nowrap; }
.ticker-text { display: inline-block; padding-left: 100%; animation: tickerScroll 40s linear infinite; font-family: 'Amiri', serif; font-size: 1.1rem; color: #e2e8f0; }
.ticker-text b { color: var(--brand-green); }
.ticker-text .dot { color: var(--brand-gold); margin: 0 20px; }
@keyframes tickerScroll { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }

.footer-grid { display: flex; justify-content: space-between; align-items: center; max-width: 1000px; margin: 0 auto; padding: 0 20px; flex-wrap: wrap; gap: 30px; }
.footer-title { font-family: 'Amiri', serif; font-size: 2.5rem; color: var(--brand-gold); margin-bottom: 10px; }
.footer-desc { color: #94a3b8; max-width: 400px; line-height: 1.6; }

.actions-col { display: flex; gap: 15px; }
.pop-btn { border: none; padding: 15px 25px; border-radius: 12px; font-weight: 700; cursor: pointer; font-family: 'Outfit', sans-serif; display: flex; align-items: center; gap: 10px; font-size: 1rem; transition: 0.3s; }
.share-btn { background: var(--brand-gold); color: #000; box-shadow: 0 5px 15px rgba(251, 191, 36, 0.3); }
.share-btn:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(251, 191, 36, 0.5); }
.bookmark-btn { background: rgba(255,255,255,0.1); color: #fff; border: 1px solid rgba(255,255,255,0.2); }
.bookmark-btn:hover { background: rgba(255,255,255,0.2); transform: translateY(-5px); }

.footer-bottom { text-align: center; margin-top: 40px; font-size: 0.8rem; color: rgba(255,255,255,0.4); font-style: italic; }

#toast-box { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.9); color: #fff; padding: 12px 24px; border-radius: 50px; border: 1px solid var(--brand-green); display: none; z-index: 1000; font-size: 0.9rem; white-space: nowrap; animation: slideUpToast 0.3s ease; }
@keyframes slideUpToast { from { bottom: 0; opacity: 0; } to { bottom: 30px; opacity: 1; } }

@media (max-width: 768px) { .footer-grid { flex-direction: column; text-align: center; } .footer-desc { margin: 0 auto; } }
/* --- FIX LIGHT MODE VISIBILITY --- */
body.light-theme .hero-arabic {
    /* Change gradient from White to Dark Blue */
    background: linear-gradient(135deg, var(--brand-gold) 20%, var(--text-primary) 80%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    
    /* Reduce the glow so it's not blurry */
    filter: drop-shadow(0 0 2px rgba(0,0,0,0.1));
}

body.light-theme .hero-dua,
body.light-theme .hero-tagline {
    color: var(--text-primary);
    font-weight: 500; /* Make it slightly bolder */
}

body.light-theme .greeting {
    background: var(--text-primary); /* Solid color instead of gradient */
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
/* --- 100x CARD ANIMATIONS --- */
@keyframes shimmerMove {
    0% { transform: translateX(-150%) skewX(-20deg); }
    100% { transform: translateX(250%) skewX(-20deg); }
}

.card {
    /* Existing styles... keep them, just add/update these: */
    backdrop-filter: blur(20px); /* Heavier blur for premium glass feel */
    border: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
    overflow: hidden;
}

/* The Golden Shimmer Effect */
.card::after {
    content: "";
    position: absolute;
    top: 0; left: 0; width: 50%; height: 100%;
    background: linear-gradient(to right, transparent, rgba(251, 191, 36, 0.05), transparent);
    transform: skewX(-20deg) translateX(-150%);
    animation: shimmerMove 6s infinite ease-in-out;
    pointer-events: none;
}

/* Staggered Entry Animation (Cascading load) */
.card, .hero, .ramadan-widget {
    animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    opacity: 0; transform: translateY(20px);
}

/* Delays for the stagger effect */
.hero { animation-delay: 0.1s; }
.card:nth-child(1) { animation-delay: 0.2s; }
.card:nth-child(2) { animation-delay: 0.3s; }
.card:nth-child(3) { animation-delay: 0.4s; }
.card:nth-child(4) { animation-delay: 0.5s; }
.card:nth-child(5) { animation-delay: 0.6s; }

@keyframes fadeInUp {
    to { opacity: 1; transform: translateY(0); }
}

/* Tactile Button Press */
button:active {
    transform: scale(0.95) !important;
}
/* --- ADHKAR TAB STYLES --- */

/* Horizontal Scroll for Chips */
.adhkar-selector-scroll {
    display: flex; gap: 10px; overflow-x: auto; padding-bottom: 15px; margin-bottom: 20px;
    scrollbar-width: none; /* Hide scrollbar */
}
.adhkar-selector-scroll::-webkit-scrollbar { display: none; }

.adhkar-chip {
    background: rgba(255,255,255,0.05); border: 1px solid var(--border);
    color: var(--text-secondary); padding: 8px 16px; border-radius: 50px;
    white-space: nowrap; cursor: pointer; transition: 0.3s; font-size: 0.9rem;
}
.adhkar-chip.active {
    background: var(--brand-gold); color: #000; font-weight: 600;
    box-shadow: 0 0 15px var(--brand-gold-glow);
}

/* The Ring */
.tasbih-ring-container {
    position: relative; width: 260px; height: 260px; margin: 0 auto;
    cursor: pointer; border-radius: 50%;
    /* Subtle pulsing glow */
    animation: breathingGlow 4s infinite ease-in-out;
}
.tasbih-ring-container:active { transform: scale(0.98); transition: 0.1s; }

@keyframes breathingGlow {
    0% { box-shadow: 0 0 20px rgba(251, 191, 36, 0.05); }
    50% { box-shadow: 0 0 40px rgba(251, 191, 36, 0.15); }
    100% { box-shadow: 0 0 20px rgba(251, 191, 36, 0.05); }
}

.progress-ring__circle {
    transition: stroke-dashoffset 0.35s;
    transform: rotate(-90deg);
    transform-origin: 50% 50%;
    stroke-linecap: round;
}

.ring-content {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    text-align: center; pointer-events: none; /* Let clicks pass through to container */
}

/* Ripple Animation on Tap */
.ripple {
    position: absolute; border-radius: 50%; background: rgba(255, 255, 255, 0.3);
    transform: scale(0); animation: rippleEffect 0.6s linear; pointer-events: none;
}
@keyframes rippleEffect {
    to { transform: scale(4); opacity: 0; }
}
/* --- ADHKAR DASHBOARD STYLES --- */

/* Category Buttons */
.adhkar-categories {
    display: flex; gap: 10px; overflow-x: auto; padding-bottom: 15px; margin-bottom: 20px;
    scrollbar-width: none; justify-content: center;
}
.adhkar-categories::-webkit-scrollbar { display: none; }

.cat-btn {
    background: transparent; border: 1px solid var(--border); color: var(--text-secondary);
    padding: 8px 20px; border-radius: 30px; cursor: pointer; transition: 0.3s;
    font-size: 0.9rem; white-space: nowrap;
}
.cat-btn.active, .cat-btn:hover {
    background: var(--brand-gold); color: #000; border-color: var(--brand-gold);
    box-shadow: 0 0 15px var(--brand-gold-glow);
}

/* The Grid */
.adhkar-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

/* Individual Dhikr Card */
.dhikr-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 25px;
    position: relative;
    overflow: hidden;
    transition: transform 0.1s;
    cursor: pointer;
    user-select: none; /* Prevents text selection on rapid tapping */
}

.dhikr-card:active { transform: scale(0.98); }

/* Progress Bar Background */
.dhikr-card::after {
    content: ''; position: absolute; bottom: 0; left: 0; height: 4px;
    background: var(--brand-gold); transition: width 0.3s;
    width: var(--progress, 0%); /* CSS Variable handled by JS */
    box-shadow: 0 0 10px var(--brand-gold);
}

.dhikr-header {
    display: flex; justify-content: space-between; align-items: flex-start;
    margin-bottom: 15px;
}

.dhikr-title { font-weight: 700; color: var(--brand-gold); font-size: 1rem; }
.dhikr-cat-tag { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; }

.dhikr-arabic {
    font-family: 'Amiri', serif; font-size: 1.8rem; line-height: 1.6;
    margin-bottom: 20px; text-align: right;
}

.dhikr-controls {
    display: flex; justify-content: space-between; align-items: center;
}

.dhikr-count {
    font-size: 2.5rem; font-weight: 700; color: var(--text-primary);
    font-family: 'Outfit', sans-serif;
}

.dhikr-target { font-size: 0.9rem; color: var(--text-secondary); margin-left: 10px; }

.reset-dhikr-btn {
    background: rgba(255,255,255,0.1); border: none; width: 35px; height: 35px;
    border-radius: 50%; color: var(--text-secondary); cursor: pointer;
    display: flex; align-items: center; justify-content: center; z-index: 5;
}
.reset-dhikr-btn:hover { background: var(--brand-gold); color: #000; }

/* Completion Glow Animation */
.dhikr-card.completed {
    border-color: var(--brand-green);
    box-shadow: 0 0 20px var(--brand-green-glow);
}
.dhikr-card.completed .dhikr-count { color: var(--brand-green); }
.dhikr-card.completed::after { background: var(--brand-green); box-shadow: 0 0 10px var(--brand-green); }
/* --- SCROLL INDICATOR STYLES --- */
.scroll-indicator {
    position: fixed; /* Positions it relative to the home section */
    bottom: 30px;      /* Distance from bottom of the 'fold' */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    z-index: 10;
    transition: opacity 0.5s ease, transform 0.5s ease;
    opacity: 0.7;
}

.scroll-indicator:hover {
    opacity: 1;
}

/* Hide it when scrolling down */
.scroll-indicator.hidden {
    opacity: 0;
    pointer-events: none;
    transform: translate(-50%, 20px);
}

.scroll-text {
    font-size: 0.75rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-secondary);
    font-weight: 500;
}

/* The Mouse Shape */
.mouse-icon {
    width: 26px;
    height: 42px;
    border: 2px solid var(--text-secondary);
    border-radius: 20px;
    position: relative;
}

/* The Little Wheel Inside */
.wheel {
    width: 4px;
    height: 8px;
    background: var(--brand-gold);
    border-radius: 2px;
    position: absolute;
    top: 6px;
    left: 50%;
    transform: translateX(-50%);
    animation: scrollWheel 2s infinite;
}

/* The Arrow */
.arrow-bounce {
    color: var(--brand-gold);
    font-size: 1rem;
    animation: bounce 2s infinite;
    animation-delay: 1s; /* Offset so it doesn't move with the wheel */
}

/* Animations */
@keyframes scrollWheel {
    0% { top: 6px; opacity: 1; }
    100% { top: 20px; opacity: 0; }
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
    60% { transform: translateY(-5px); }
}

/* Mobile Adjustment: Move it up slightly so address bar doesn't hide it */
@media (max-width: 768px) {
    .scroll-indicator { bottom: 100px; } 
    /* Or hide the mouse icon on mobile to save space */
    .mouse-icon { display: none; }
}

/* --- THANK YOU MODAL STYLES --- */
.modal-overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.8); /* Dark dim background */
    backdrop-filter: blur(8px);
    z-index: 2000; /* Above everything */
    display: none; /* Hidden by default */
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.modal-overlay.show {
    display: flex;
    opacity: 1;
}

.modal-card {
    background: var(--bg-card);
    border: 1px solid var(--brand-gold);
    box-shadow: 0 0 50px var(--brand-gold-glow);
    padding: 40px 30px;
    border-radius: 24px;
    max-width: 400px;
    width: 90%;
    text-align: center;
    position: relative;
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.modal-overlay.show .modal-card {
    transform: scale(1);
}

.close-modal {
    position: absolute; top: 15px; right: 20px;
    background: none; border: none;
    color: var(--text-secondary); font-size: 2rem;
    cursor: pointer;
}

.modal-icon-wrapper {
    width: 80px; height: 80px;
    background: rgba(251, 191, 36, 0.1);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    margin: 0 auto 20px auto;
    border: 2px solid var(--brand-gold);
}

.modal-icon {
    font-size: 2.5rem; color: var(--brand-gold);
    animation: heartBeat 1.5s infinite;
}

@keyframes heartBeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

.modal-title {
    font-family: 'Amiri', serif;
    font-size: 2.2rem;
    color: var(--text-primary);
    margin-bottom: 10px;
}

.modal-text {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 25px;
}

/* Feedback Tags */
.tag-container {
    display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;
}

.tag-btn {
    background: rgba(255,255,255,0.05);
    border: 1px solid var(--border);
    color: var(--text-secondary);
    padding: 8px 15px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.85rem;
    transition: 0.3s;
}

.tag-btn:hover, .tag-btn.selected {
    background: var(--brand-gold);
    color: #000;
    border-color: var(--brand-gold);
    transform: translateY(-2px);
}

.modal-footer-quote {
    margin-top: 30px;
    font-size: 0.8rem;
    font-style: italic;
    color: var(--brand-green);
    border-top: 1px solid var(--border);
    padding-top: 15px;
}
/* NEW LOGO STYLES */
.brand-lockup {
    display: flex;
    align-items: center;
    gap: 12px;
    filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.15));
}
.brand-emblem {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
    animation: slowPulse 4s infinite ease-in-out;
}
.brand-text-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    line-height: 1;
}
.brand-daily {
    font-family: 'Outfit', sans-serif;
    font-size: 0.7rem;
    font-weight: 600;
    letter-spacing: 3px; 
    text-transform: uppercase;
    color: var(--text-secondary);
    margin-bottom: 2px;
    margin-left: 2px;
}
.brand-deen {
    font-family: 'Amiri', serif; 
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--brand-gold);
    background: linear-gradient(135deg, #fbbf24 0%, #ffe4a0 50%, #d97706 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: 0.5px;
}
@keyframes slowPulse {
    0%, 100% { transform: scale(1); filter: drop-shadow(0 0 5px var(--brand-gold-glow)); }
    50% { transform: scale(1.03); filter: drop-shadow(0 0 15px var(--brand-gold-glow)); }
}
@media (max-width: 768px) {
    .brand-emblem { width: 40px; height: 40px; }
    .brand-daily { font-size: 0.65rem; letter-spacing: 2px; }
    .brand-deen { font-size: 1.5rem; }
}
/* =========================================
   MOBILE REPAIR KIT (Add to bottom of CSS)
   ========================================= */
/* --- MASTER MOBILE STYLES (Bottom Nav + Layout Fixes) --- */
/* --- MASTER MOBILE STYLES (Bottom Nav + Layout Fixes) --- */
@media (max-width: 768px) {
    
    /* 1. BOTTOM NAVIGATION (The Thumb Zone) */
    nav { 
        position: fixed; 
        bottom: 0; 
        top: auto; 
        width: 100%;
        padding: 10px 15px; 
        border-top: 1px solid var(--border); 
        border-bottom: none; 
        background: rgba(0, 0, 0, 0.95); 
        backdrop-filter: blur(10px);
        justify-content: center;
        box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        z-index: 1000;
    }

    .brand, .theme-toggle { display: none; } 
    
    .nav-menu { 
        width: 100%; 
        justify-content: space-between; 
        background: transparent; 
        border: none; 
        padding: 0;
        display: flex;
    }
    
    .nav-btn { 
        padding: 8px; 
        border-radius: 12px; 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        gap: 4px;
        flex: 1; 
        background: transparent;
        color: var(--text-secondary);
        font-size: 0.7rem; 
    }

    .nav-btn i { font-size: 1.2rem; margin-bottom: 2px; }
    .nav-label { font-size: 0.65rem; font-weight: 500; }

    .nav-btn.active { 
        background: transparent; 
        color: var(--brand-gold); 
        box-shadow: none; 
    }
    .nav-btn.active i {
        filter: drop-shadow(0 0 8px var(--brand-gold));
        transform: translateY(-2px);
        transition: 0.3s;
    }
    
    /* 2. LAYOUT & FOOTER FIXES */
    body { 
        padding-bottom: 0; /* Reset body padding */
        overflow-x: hidden; 
    } 
    
    .container { 
        padding: 20px 15px; 
        padding-bottom: 20px; 
        overflow-x: hidden; 
    }

    /* Add the padding directly to the footer so the background looks right */
    footer {
        padding-bottom: 110px !important; 
    }
    
    /* 3. RAMADAN WIDGET FIX */
    .ramadan-widget { 
        position: relative; 
        top: 0; 
        right: 0; 
        width: 100%; 
        flex-direction: row-reverse; 
        justify-content: space-between; 
        align-items: center; 
        margin-bottom: 20px; 
        padding: 10px;
    }
    .ramadan-days-left { font-size: 0.8rem; margin-right: 0; margin-top: 0; }

    /* 4. SETTINGS INPUT FIX */
    .input-group { flex-direction: column; width: 100%; }
    .styled-input { width: 100%; max-width: 100% !important; margin-bottom: 10px; }
}

/* Bismillah Screen */
#bismillah-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
    background: #000; z-index: 9999;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    transition: opacity 1.5s ease-out;
    pointer-events: none; /* Allows click-through after fading */
}
.bismillah-text {
    font-family: 'Amiri', serif; font-size: 3rem; color: var(--brand-gold);
    animation: glowText 3s infinite alternate; text-align: center; padding: 0 20px;
}
.bismillah-eng {
    font-family: 'Outfit', sans-serif; font-size: 0.9rem; color: #fff; opacity: 0.6; margin-top: 15px; letter-spacing: 3px; text-transform: uppercase; text-align: center;
}
@keyframes glowText { from { text-shadow: 0 0 10px rgba(251, 191, 36, 0.2); } to { text-shadow: 0 0 30px rgba(251, 191, 36, 0.6); } }

/* Dignified Developer Request */
#developer-request {
    border: 1px solid var(--brand-gold);
    background: linear-gradient(180deg, rgba(251, 191, 36, 0.05) 0%, rgba(0,0,0,0.4) 100%);
    box-shadow: 0 0 30px rgba(251, 191, 36, 0.1);
}
#developer-request .card-header {
    justify-content: center; border-bottom: 1px solid rgba(251, 191, 36, 0.2);
    padding-bottom: 15px; margin-bottom: 20px; font-family: 'Amiri', serif; font-size: 1.2rem;
}

/* --- 1. CINEMATIC TEXTURE (Film Grain) --- */
body::before {
    content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
    opacity: 0.07; pointer-events: none; z-index: 9999; mix-blend-mode: overlay;
}

/* --- 2. SWIPE LAYOUT (Horizontal Scroll) --- */
/* --- 2. PERFECT SNAP CARDS (Fixed) --- */
.horizontal-scroll { display: contents; } /* Desktop: Normal Grid */

@media (max-width: 768px) {
    .horizontal-scroll {
        display: flex;
        overflow-x: auto;
        gap: 15px;
        padding: 10px 20px 20px 20px; /* Padding for shadow breathing room */
        margin: 0 -15px; /* Bleed to edge */
        
        /* The "Magnetic" Snap */
        scroll-snap-type: x mandatory; 
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        
        /* Alignment helper */
        align-items: stretch; 
    }
    .horizontal-scroll::-webkit-scrollbar { display: none; }
    
    .swipe-card {
        /* Force single card focus */
        min-width: 88vw; 
        max-width: 88vw;
        
        /* FIXED HEIGHT (Crucial for clean look) */
        height: 280px; 
        display: flex; 
        flex-direction: column;
        
        /* Snap Logic */
        scroll-snap-align: center;
        scroll-snap-stop: always; /* Forces it to stop on a card */
        flex-shrink: 0;
        
        /* Visuals */
        margin: 0;
        background: var(--bg-card); 
    }

    /* Handle Long Text (Scroll inside the card) */
    .swipe-card .card-header {
        flex-shrink: 0; /* Header stays at top */
    }
    .swipe-card > div:not(.card-header) {
        overflow-y: auto; /* Scroll text if too long */
        padding-right: 5px; /* Space for scrollbar */
        justify-content: flex-start !important; /* Align text to top */
        padding-top: 10px;
    }
}

/* --- 3. BREATHING COUNTDOWN BORDER --- */
#countdown-panel {
    position: relative; overflow: hidden; border: 2px solid transparent; background-clip: padding-box;
}
#countdown-panel::before {
    content: ''; position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index: -1; margin: -2px; border-radius: inherit;
    background: linear-gradient(45deg, var(--brand-gold), #7c2d12, var(--brand-gold));
    background-size: 200% 200%; animation: borderFlow 4s ease infinite;
}
@keyframes borderFlow { 0% { background-position: 0% 50%; } 100% { background-position: 0% 50%; } }


</style>
</head>
<body>
    <div id="bismillah-screen">
    <div class="bismillah-text">بِسْمِ ٱللَّٰهِ ٱلرَّحْمَٰنِ ٱلرَّحِيمِ</div>
    <div class="bismillah-eng">In the Name of Allah, the Most Gracious, the Most Merciful</div>
</div>

    <nav>
        <div class="brand-lockup">
    <svg class="brand-emblem" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <linearGradient id="gold-grad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
            </linearGradient>
        </defs>
        <path d="M50,10 C27.9,10 10,27.9 10,50 C10,72.1 27.9,90 50,90 C54.5,90 58.8,89.2 62.9,87.8 C55.2,85.9 48.5,81.7 43.6,75.9 C38.7,70.1 36,62.7 36,55 C36,42.5 43.1,31.6 53.6,25.9 C52.4,25.6 51.2,25.5 50,25.5 C36.5,25.5 25.5,36.5 25.5,50 C25.5,63.5 36.5,74.5 50,74.5 C54.8,74.5 59.3,73.1 63.1,70.6 C65.1,73.7 67.8,76.3 71,78.2 C64.9,82.3 57.7,84.5 50,84.5 C31,84.5 15.5,69 15.5,50 C15.5,31 31,15.5 50,15.5 C57.6,15.5 64.6,17.9 70.6,21.9 C65.9,25.1 62.3,29.6 60.1,34.8 C65.3,32.6 71.1,31.4 77.3,31.4 C79.1,31.4 80.9,31.6 82.6,31.9 C84.8,25.2 83.9,17.7 79.7,11.8 C72,16.9 62.3,20 52,20 C51.3,20 50.7,20 50,19.9 L50,10 Z M77.3,36.9 C72.8,36.9 68.4,37.9 64.5,39.6 C67,42.9 68.5,46.9 68.5,51.2 C68.5,57.2 65.6,62.5 61.1,65.9 C64,67.2 67.2,67.9 70.6,67.9 C78.8,67.9 85.6,61.5 86.3,53.5 C86.4,52.7 86.5,52 86.5,51.2 C86.5,43.3 82.4,36.9 77.3,36.9 Z M56.5,51.2 C56.5,48.3 55.6,45.6 54.1,43.3 C52.2,45.5 51,48.2 51,51.2 C51,54.2 52.2,56.9 54.1,59.1 C55.6,56.8 56.5,54.1 56.5,51.2 Z" fill="url(#gold-grad)"/>
    </svg>
    <div class="brand-text-container">
        <span class="brand-daily">DAILY</span>
        <span class="brand-deen">Deen</span>
    </div>
</div>
       <div class="nav-menu">
    <button class="nav-btn active" onclick="switchTab('home', this)">
        <i class="fas fa-home"></i> <span class="nav-label">Home</span>
    </button>
    <button class="nav-btn" onclick="switchTab('qibla', this)">
        <i class="fas fa-compass"></i> <span class="nav-label">Qibla</span>
    </button>
    <button class="nav-btn" onclick="switchTab('quran', this)">
        <i class="fas fa-book-open"></i> <span class="nav-label">Quran</span>
    </button>
    <button class="nav-btn" onclick="switchTab('adhkar', this)">
        <i class="fas fa-fingerprint"></i> <span class="nav-label">Adhkar</span>
    </button>
    <button class="nav-btn" onclick="switchTab('serenity', this)">
        <i class="fas fa-cloud-moon"></i> <span class="nav-label">Serenity</span>
    </button>
    <button class="nav-btn" onclick="switchTab('settings', this)">
        <i class="fas fa-cog"></i> <span class="nav-label">Settings</span>
    </button>
</div>
        <button class="theme-toggle" onclick="toggleTheme()"><i class="fas fa-sun"></i></button>
    </nav>

    <div class="container">
        <div class="ramadan-widget">
        <button class="ramadan-btn" id="ramadan-toggle" onclick="toggleRamadanMode()">
            <i class="fas fa-moon"></i> Ramadan Mode: OFF
        </button>
        <div id="ramadan-countdown-text" class="ramadan-days-left">
            Loading...
        </div>
    </div>
        

        <section id="home" class="view-section active">
           <div class="hero">
    <div class="hero-content">
        

        <div class="hero-arabic" style="font-size: 2.5rem; line-height: 1.4;">
            ٱلسَّلَامُ عَلَيْكُمْ وَرَحْمَةُ ٱللَّٰهِ وَبَرَكَاتُهُ
        </div>
        <div style="font-family: 'Amiri', serif; font-size: 1.8rem; color: var(--text-secondary); margin-bottom: 5px; opacity: 0.9;">
            أَهْلًا وَسَهْلًا
        </div>
        
        <div class="hero-tagline">Your Daily Companion for Prayer, Remembrance & Reflection</div>
        
        <div class="hero-dua">"May Allah place light in your heart"</div>
        
        <div style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top: 25px;">
            <div class="date-badge" id="gregorian-date" style="border-color: var(--border); color: var(--text-secondary); background: transparent;">
                Loading...
            </div>
            <div class="date-badge" id="hijri-date">
                Loading Date...
            </div>
        </div>
    </div>
</div>

   <div class="scroll-indicator" onclick="scrollToGrid()">
        <span class="scroll-text">Scroll to Begin</span>
        <div class="mouse-icon">
            <div class="wheel"></div>
        </div>
        <i class="fas fa-chevron-down arrow-bounce"></i>
    </div>


    

<div class="card" style="margin-bottom: 25px; border-color: var(--brand-green-glow);">
    <div class="card-header"><i class="fas fa-heartbeat" style="color: var(--brand-green);"></i> How is your heart today?</div>
    <div class="mood-selector" id="mood-selector">
        <button onclick="showRemedy('anxious')" class="mood-btn">🌪️ Anxious</button>
        <button onclick="showRemedy('sad')" class="mood-btn">🌧️ Sad</button>
        <button onclick="showRemedy('lazy')" class="mood-btn">💤 Lazy</button>
        <button onclick="showRemedy('grateful')" class="mood-btn">☀️ Grateful</button>
        <button onclick="showRemedy('sinful')" class="mood-btn">💔 Distant</button>
    </div>
    <div id="remedy-box" style="display:none; margin-top: 20px; text-align: center; animation: fadeIn 0.5s;">
        <h3 id="remedy-title" style="color: var(--brand-gold); font-family: 'Amiri', serif; margin-bottom: 10px;"></h3>
        <p id="remedy-arabic" style="font-family: 'Amiri', serif; font-size: 1.5rem; line-height: 1.8; margin-bottom: 10px;"></p>
        <p id="remedy-translation" style="color: var(--text-secondary); font-style: italic; margin-bottom: 15px;"></p>
        <button onclick="resetMood()" style="background: transparent; border: 1px solid var(--border); color: var(--text-secondary); padding: 5px 15px; border-radius: 20px; cursor: pointer; font-size: 0.8rem;">Choose Another</button>
    </div>
</div>

<div class="card" style="margin-bottom: 25px;">
    <div class="card-header"><i class="fas fa-list-check"></i> Daily Checklist</div>
    <div id="sunnah-list" class="checklist-container"></div>
    <p style="text-align:center; font-size:0.75rem; color:var(--text-secondary); margin-top:10px;">*Resets automatically at midnight</p>
</div>
            <div class="grid">
                <div class="card">
                    <div class="card-header">
    <i class="fas fa-mosque"></i> 
    <span>Prayer Times</span>
    <span id="active-city-label" style="margin-left: auto; font-size: 0.8rem; color: var(--brand-gold); text-transform: capitalize;"></span>
</div>
                    <div id="ramadan-card" class="card" style="display:none; border: 1px solid var(--brand-gold);">
        <div class="card-header"><i class="fas fa-star-and-crescent"></i> Ramadan Tracker</div>
        
        <div style="display:flex; justify-content:space-between; align-items:center; background:var(--input-bg); padding:10px; border-radius:10px; margin-bottom:10px;">
            <span>Taraweeh</span>
            <div style="display:flex; gap:10px; align-items:center;">
                <button onclick="modCount('taraweeh', -2)" style="width:30px; height:30px; border-radius:50%; border:none; background:var(--brand-green); color:#000; font-weight:bold;">-</button>
                <span id="taraweeh-count" style="font-weight:bold; width:20px; text-align:center;">0</span>
                <button onclick="modCount('taraweeh', 2)" style="width:30px; height:30px; border-radius:50%; border:none; background:var(--brand-green); color:#000; font-weight:bold;">+</button>
            </div>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center; background:var(--input-bg); padding:10px; border-radius:10px;">
            <span>Missed Fasts</span>
            <div style="display:flex; gap:10px; align-items:center;">
                <button onclick="modCount('qada', -1)" style="width:30px; height:30px; border-radius:50%; border:none; background:var(--brand-green); color:#000; font-weight:bold;">-</button>
                <span id="qada-count" style="font-weight:bold; width:20px; text-align:center;">0</span>
                <button onclick="modCount('qada', 1)" style="width:30px; height:30px; border-radius:50%; border:none; background:var(--brand-green); color:#000; font-weight:bold;">+</button>
            </div>
        </div>

        <div id="ramadan-tip" style="margin-top:15px; font-size:0.9rem; font-style:italic; text-align:center; color:var(--brand-gold);"></div>
    </div>
    <div id="countdown-panel" style="text-align:center; background:rgba(251, 191, 36, 0.1); padding:15px; border-radius:12px; margin-bottom:20px; border:1px solid var(--brand-gold-glow); display:none;">
    <div id="next-prayer-name" style="font-size:0.8rem; letter-spacing:1px; color:var(--text-secondary); margin-bottom:5px; font-weight:600;">NEXT PRAYER</div>
    <div id="time-remaining" style="font-size:2.5rem; font-weight:700; color:var(--brand-gold); line-height:1; font-family:'Outfit', monospace; font-variant-numeric: tabular-nums;">--:--:--</div>
</div>
<div id="prayer-container">
    

    <div style="text-align:center; padding: 10px 0; margin-bottom:10px;">
        <p style="color:var(--text-secondary); font-size:0.9rem; margin:0;">
            To change city, go to <b style="color:var(--brand-gold);">Settings</b><br>
            and use <b>GPS</b> or enter <b>City Name</b>.
        </p>
    </div>

    <div id="prayer-list-render">
        <div class="spinner"></div>
    </div>
</div>


<div id="countdown-panel" style="text-align:center; background:rgba(251, 191, 36, 0.1); padding:15px; border-radius:12px; margin-bottom:20px; border:1px solid var(--brand-gold-glow); display:none;">
    
<div class="spinner"></div>

                        <p style="text-align:center; color:var(--text-secondary)">Please set your location in Settings.</p>
                    </div>
                </div>

<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:-15px; padding: 0 5px; opacity:0.7;">
        <span style="font-size:0.7rem; font-weight:600; letter-spacing:1px;">DAILY INSPIRATION</span>
        <span style="font-size:0.7rem;"><i class="fas fa-chevron-right"></i></span>
    </div>

    <div class="horizontal-scroll">
        <div class="card swipe-card">
            <div class="card-header"><i class="fas fa-book-open"></i> Daily Verse</div>
            <div style="flex:1; display:flex; flex-direction:column; justify-content:center;">
                <p id="verse-ar" style="font-family:'Amiri'; font-size:1.5rem; text-align:center; line-height:1.8; margin-bottom:10px;">Loading...</p>
                <p id="verse-en" style="font-size:0.95rem; color:var(--text-secondary); text-align:center; font-style:italic;">...</p>
                <p id="verse-ref" style="text-align:center; color:var(--brand-gold); font-size:0.8rem; margin-top:10px; font-weight:bold;"></p>
            </div>
        </div>

        <div class="card swipe-card">
            <div class="card-header"><i class="fas fa-scroll"></i> Daily Hadith</div>
            <div style="flex:1; display:flex; flex-direction:column; justify-content:center;">
                <p id="hadith-text" style="font-size:1rem; line-height:1.5; text-align:center;">Loading...</p>
                <p id="hadith-ref" style="text-align:right; color:var(--brand-gold); font-size:0.75rem; margin-top:10px; font-weight:bold;"></p>
            </div>
        </div>

        <div class="card swipe-card">
            <div class="card-header"><i class="fas fa-hands-praying"></i> Daily Dua</div>
            <div style="flex:1; display:flex; flex-direction:column; justify-content:center;">
                <p id="dua-ar" style="font-family:'Amiri'; font-size:1.6rem; text-align:center; line-height:1.8; margin-bottom:10px;">Loading...</p>
                <p id="dua-en" style="color:var(--text-secondary); text-align:center; font-style:italic;">...</p>
            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-header">
            <i class="fas fa-star"></i> Name of Allah SWT
            <button onclick="toggleNameDua()" style="margin-left:auto; background:rgba(255,255,255,0.1); border:none; color:var(--brand-gold); padding:5px 12px; border-radius:15px; cursor:pointer; font-size:0.75rem;">
                <i class="fas fa-hands-praying"></i> How to Ask
            </button>
        </div>
        <div style="text-align:center;">
            <p id="name-ar" style="font-family:'Amiri'; font-size:3rem; color:var(--brand-gold); text-shadow:0 0 20px var(--brand-gold-glow);">Loading...</p>
            <p id="name-en" style="font-weight:700; font-size:1.4rem; margin-top:5px;">...</p>
            <p id="name-meaning" style="color:var(--text-secondary); font-size:0.9rem; font-style:italic;">...</p>
        </div>
        <div id="name-dua-box" style="display:none; margin-top:20px; padding-top:15px; border-top:1px solid var(--border);">
            <div style="background:rgba(251, 191, 36, 0.1); padding:15px; border-radius:12px; border-left:3px solid var(--brand-gold); text-align:left;">
                <div style="font-weight:700; color:var(--brand-gold); font-size:0.75rem; margin-bottom:5px; text-transform:uppercase;">
                    <i class="fas fa-key"></i> Use this in your Dua:
                </div>
                <p id="name-dua" style="font-size:1rem; color:var(--text-primary); line-height:1.5; font-weight:500;">...</p>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><i class="fas fa-seedling"></i> Good Deed</div>
        <p id="deed-text" style="font-size:1.2rem; text-align:center; margin:15px 0;">...</p>
        <button class="btn-action" onclick="newDeed()"><i class="fas fa-sync-alt"></i> New Deed</button>
    </div>

<div class="card" style="border-color: var(--brand-gold-glow);">
    <div class="card-header">
        <i class="fas fa-lightbulb" style="color: var(--brand-gold);"></i> Help Us Improve
    </div>
    <div style="text-align: center;">
        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 15px;">
            This site is built for the Ummah. What feature or Dua should we add next?
        </p>
        <textarea id="feedback-input" class="styled-input" rows="3" placeholder="I wish this app had..." style="width: 100%; resize: none; margin-bottom: 15px;"></textarea>
        
        <button class="btn-action" onclick="openThankYouModal()" style="background: var(--bg-nav); border: 1px solid var(--brand-gold); color: var(--brand-gold);">
            <i class="fas fa-paper-plane"></i> Send Suggestion
        </button>
    </div>
</div>

<div class="card" id="developer-request" style="grid-column: 1 / -1;">
    
    <div class="card-header" style="justify-content: center; color: var(--brand-gold); text-align:center;">
        <i class="fas fa-heart" style="margin-right:8px;"></i> A Personal Request from the Developer
    </div>

    <div style="text-align: center; max-width: 600px; margin: 0 auto;">
        
        <p style="font-family: 'Amiri', serif; font-size: 1.2rem; line-height: 1.6; color: var(--text-primary); margin-bottom: 15px;">
            I built <b>Daily Deen</b> as a Sadaqah Jariyah, inspired entirely by a woman I deeply love for the sake of Allah.
        </p>

        <div style="background: rgba(251, 191, 36, 0.1); border-left: 3px solid var(--brand-gold); padding: 15px; text-align: left; margin-bottom: 25px; border-radius: 4px;">
            <p style="color: var(--text-primary); font-size: 0.95rem; line-height: 1.6; margin: 0;">
                <strong style="color: var(--brand-gold);">My Humble Request:</strong> <br>
                Although my heart is attached to her, <b>she has not yet accepted my proposal.</b> 
                I ask you to please raise your hands and pray that Allah softens her heart towards me, grants me acceptance in her eyes, and writes my name next to hers in a blessed, Halal marriage.
            </p>
        </div>

        <p style="font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px;">
            Please also pray for her <b>success in her studies</b>, and for her parents and family to be blessed with health, happiness, and peace.
        </p>

        <div style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 15px; border: 1px solid var(--border); margin-bottom: 20px;">
            <p style="font-family: 'Amiri', serif; font-size: 1.4rem; color: var(--brand-gold); margin-bottom: 10px; line-height: 1.6;">
                اللَّهُمَّ لَيِّنْ قَلْبَهَا لِي كَمَا لَيَّنْتَ الْحَدِيدَ لِدَاوُدَ
            </p>
            <p style="font-size: 0.9rem; font-style: italic; color: var(--text-secondary);">
                "O Allah, soften her heart for me just as You softened iron for Dawud (AS)."
            </p>
        </div>

        <button id="ameen-btn" onclick="sayAmeen(this)" style="background: var(--bg-nav); border: 1px solid var(--brand-gold); color: var(--brand-gold); padding: 12px 35px; border-radius: 50px; cursor: pointer; transition: 0.4s; font-family: 'Outfit', sans-serif; font-weight: 600; font-size: 1rem;">
            <i class="fas fa-hands-praying"></i> Say Ameen for Me
        </button>

        <p id="ameen-msg" style="font-size: 0.75rem; color: var(--brand-green); margin-top: 15px; opacity: 0; transition: 0.5s;">
            May Allah accept your prayer and give you the same. JazakAllah Khair.
        </p>
    </div>
</div>

</div>
        </section>

        <section id="qibla" class="view-section">
            <div class="hero">
                <h1 class="greeting">Qibla Finder</h1>
                <p style="color:var(--text-secondary)">Align the arrow with the degree shown below on a compass app.</p>
            </div>
            <div class="compass-wrapper">
                <i class="fas fa-kaaba kaaba-pointer"></i>
                <div class="compass-deg" id="qibla-deg">--°</div>
            </div>
            <p style="text-align:center; margin-top:60px; color:var(--text-secondary)">Calculated from: <span id="qibla-city-label" style="color:var(--brand-gold)">Unknown</span></p>
            <div style="margin-top: 30px; padding: 15px; background: rgba(16, 185, 129, 0.1); border: 1px solid var(--brand-green-glow); border-radius: 12px; text-align: center;">
    <p style="font-size: 0.85rem; color: var(--text-secondary);">
        <i class="fas fa-shield-alt" style="color: var(--brand-green); margin-right: 5px;"></i>
        <b>Privacy Notice:</b> We do not track, store, or share your location data. All Qibla calculations happen locally on your device.
    </p>
</div>
        </section>

        <section id="quran" class="view-section">
            <div class="hero">
                <h1 class="greeting">Noble Quran</h1>
                <p style="color:var(--text-secondary)">Select a Surah to read</p>
            </div>
            
            <div id="surah-list-view" class="surah-list">
                <div class="spinner"></div>
            </div>

            <div id="surah-read-view" style="display:none;">
                <button onclick="closeSurah()" style="background:none; border:none; color:var(--brand-gold); cursor:pointer; margin-bottom:20px; font-size:1rem; display:flex; align-items:center; gap:8px;">
                    <i class="fas fa-arrow-left"></i> Back to List
                </button>
                <div class="card">
                    <h2 id="read-title" style="text-align:center; margin-bottom:30px; color:var(--brand-gold);">Surah</h2>
                    <div id="ayah-container"></div>
                </div>
            </div>
        </section>

        <section id="adhkar" class="view-section">
    <div class="hero">
        <h1 class="greeting">Dhikr & Remembrance</h1>
        <p style="color:var(--text-secondary)">Purify your heart with the remembrance of Allah.</p>
    </div>


    <div class="adhkar-categories">
        <button class="cat-btn active" onclick="filterAdhkar('all', this)">All</button>
        <button class="cat-btn" onclick="filterAdhkar('general', this)">General</button>
        <button class="cat-btn" onclick="filterAdhkar('morning', this)">Morning</button>
        <button class="cat-btn" onclick="filterAdhkar('evening', this)">Evening</button>
        <button class="cat-btn" onclick="filterAdhkar('salah', this)">After Salah</button>
    </div>

    <div id="adhkar-grid" class="adhkar-grid">
        </div>

    <button onclick="addCustomDhikr()" class="btn-action" style="margin-top: 30px; background: rgba(255,255,255,0.1); border: 1px solid var(--border);">
        <i class="fas fa-plus"></i> Add Custom Dhikr
    </button>

</section>

       <section id="serenity" class="view-section">
    
    <div class="serenity-header">
        <h1 class="serenity-title">Serenity Station</h1>
        <p class="serenity-caption">Your space for studying, sleeping, or just relaxation with peace.</p>
    </div>

    <div class="mood-grid">
        <div class="mood-card active" onclick="playMood('study', this)">
            <span class="mood-icon">📚</span>
            <span class="mood-name">Study / Lofi</span>
        </div>
        <div class="mood-card" onclick="playMood('sleep', this)">
            <span class="mood-icon">🌙</span>
            <span class="mood-name">Deep Sleep</span>
        </div>
        <div class="mood-card" onclick="playMood('nasheed', this)">
            <span class="mood-icon">🎤</span>
            <span class="mood-name">Soft Nasheed</span>
        </div>
        <div class="mood-card" onclick="playMood('nature', this)">
            <span class="mood-icon">🌧️</span>
            <span class="mood-name">Rain & Quran</span>
        </div>
    </div>

    <div class="player-container">
        <div id="playing-label" class="now-playing">Select a mood to begin...</div>
        <div class="iframe-container">
            <iframe id="serenity-player" src="" title="Serenity Player"
            frameborder="0"
            referrerpolicy="strict-origin-when-cross-origin"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        </div>

        <div style="text-align:center; margin-top:10px;">
    <button onclick="updateVideoID()" style="background:none; border:none; color:rgba(255,255,255,0.5); font-size:0.75rem; cursor:pointer; text-decoration:underline;">
        Video broken? Click to set new ID
    </button>
</div>


        
        <div style="margin-top:15px; font-family:'Outfit'; opacity:0.7;">
            <i class="far fa-clock"></i> Local Time: <span id="serenity-clock">--:--</span>
        </div>
    </div>

</section>

        <section id="settings" class="view-section">
            <div class="hero">
                <h1 class="greeting">Settings</h1>
            </div>
            <div class="card" style="max-width:600px; margin:0 auto;">
                <div class="card-header"><i class="fas fa-map-marker-alt"></i> Location</div>
                <button id="install-btn" style="display:none; margin-bottom:15px; background:var(--text-primary); color:var(--bg-body);" class="btn-action">
    <i class="fas fa-download"></i> Install App
</button>
                <button onclick="getGPSLocation()" class="btn-action" style="margin-bottom:15px; background:var(--brand-gold); color:#000;">
    <i class="fas fa-location-arrow"></i> Auto-Detect Location (GPS)
</button>
                <div class="input-group">
                    <input type="text" id="set-city" class="styled-input" placeholder="City (e.g. Toronto)">
                    <input type="text" id="set-country" class="styled-input" placeholder="Country" style="max-width:100px;">
                </div>
                <div style="margin-top: 20px; margin-bottom: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
    <div style="font-weight:600; margin-bottom:10px; color:var(--text-secondary);"><i class="fas fa-glasses"></i> Text Size</div>
    <div style="display:flex; gap:10px; justify-content:center;">
        <button onclick="changeFontSize('normal')" style="padding:10px 20px; border-radius:10px; border:1px solid var(--border); background:var(--bg-nav); color:var(--text-primary);">A</button>
        <button onclick="changeFontSize('large')" style="padding:10px 20px; border-radius:10px; border:1px solid var(--brand-gold); background:var(--bg-nav); color:var(--brand-gold); font-size:1.2rem; font-weight:bold;">A+</button>
        <button onclick="changeFontSize('extra')" style="padding:10px 20px; border-radius:10px; border:1px solid var(--brand-gold); background:var(--bg-nav); color:var(--brand-gold); font-size:1.5rem; font-weight:bold;">A++</button>
    </div>
</div>
                <button class="btn-action" onclick="saveSettings()">Save Changes</button>
                <p id="save-msg" style="text-align:center; color:var(--brand-green); margin-top:15px; display:none;">Saved Successfully!</p>
                <div style="margin-top: 20px; text-align: center; opacity: 0.7;">
    <p style="font-size: 0.8rem; color: var(--text-secondary);">
        <i class="fas fa-lock" style="color: var(--brand-gold); margin-right: 5px;"></i>
        Your settings are stored in your browser's <b>Local Storage</b>. No data is sent to any external server.
    </p>
</div>
            </div>
        </section>

    </div>

    <div class="footer-wave">
    <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
        <path d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z" class="shape-fill"></path>
    </svg>
</div>

<footer id="spiritual-footer">
    <div class="sadaqah-wrapper">
        <div class="sadaqah-badge">
            <i class="fas fa-hand-holding-heart"></i> SADAQAH JARIYAH • NO ADS • FREE FOREVER
        </div>
    </div>

    <div class="ticker-container">
        <div class="ticker-text">
            <span> <b>O Allah</b>, help our brothers and sisters in Palestine. Keep them safe and give them victory.</span>
            <span class="dot">✦</span>
            <span><b>O Allah</b>, You are the Healer. Please cure everyone who is in pain today.</span>
            <span class="dot">✦</span>
            <span><b>O Allah</b>, forgive those who have passed away. Fill their graves with light and give them Paradise.</span>
            <span class="dot">✦</span>
            <span><b>O Allah</b>, fix our broken hearts. Replace our sadness with peace and calm.</span>
            <span class="dot">✦</span>
            <span><b>O Allah</b>, feed the hungry and give homes to the homeless everywhere.</span>
            <span class="dot">✦</span>
            <span><b>O Allah</b>, forgive all my mistakes, the big ones and the small ones.</span>
        </div>
    </div>

    <div class="footer-grid">
        <div class="footer-col">
            <h3 class="footer-title">Daily Deen</h3>
            <p class="footer-desc">Built with love for the sake of Allah. Please keep the developer in your humble Duas.</p>
        </div>
        <div class="footer-col actions-col">
            <button onclick="shareApp()" class="pop-btn share-btn"><i class="fas fa-share-nodes"></i> Share Rewards</button>
            <button onclick="bookmarkApp()" class="pop-btn bookmark-btn"><i class="fas fa-bookmark"></i> Bookmark App</button>
        </div>
    </div>

    <div class="footer-bottom">May this site be a witness for us on the Day of Judgment.</div>
</footer>
<div id="toast-box"></div>

<div id="thank-you-modal" class="modal-overlay">
    <div class="modal-card">
        <button class="close-modal" onclick="closeThankYouModal()">&times;</button>
        
        <div class="modal-icon-wrapper">
            <i class="fas fa-heart modal-icon"></i>
        </div>

        <h2 class="modal-title">JazakAllah Khair!</h2>
        <p class="modal-text">
            Your feedback is an Amanah (trust) to us. We are building this specifically to help you connect with Allah swt.
        </p>

        <div class="feedback-tags">
            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 10px;">Which area needs the most love?</p>
            <div class="tag-container">
                <button class="tag-btn" onclick="selectTag(this)">🎨 Design</button>
                <button class="tag-btn" onclick="selectTag(this)">📖 More Duas</button>
                <button class="tag-btn" onclick="selectTag(this)">⚡ Features</button>
                <button class="tag-btn" onclick="selectTag(this)">🐛 Bugs</button>
            </div>
        </div>

        <div class="modal-footer-quote">
            "The most beloved of people to Allah are those who are most beneficial to people."
        </div>
    </div>
</div>


    <script>
        /* --- REGISTER SERVICE WORKER (Required for Install Prompt) --- */
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js')
        .then(() => console.log('Service Worker Registered'))
        .catch((err) => console.log('SW Error:', err));
}

     window.addEventListener('load', () => {
    /* --- 1. START THE APP LOGIC (This was missing!) --- */
    console.log("App Starting..."); // Debug message
    updateAtmosphere();
    updateGregorianDate();
    loadDailyVerse();
    loadDailyHadith();
    initChecklist();
    generateDailyContent();

    /* --- 2. LOAD LOCATION & PRAYERS --- */
    const savedCity = localStorage.getItem('city');
    
    if(savedCity && savedCity !== "GPS Location") {
        // Case A: User saved a city manually
        document.getElementById('set-city').value = savedCity;
        loadPrayers(savedCity, localStorage.getItem('country') || "");
        
    } else if (localStorage.getItem('lat') && localStorage.getItem('long')) {
        // Case B: User saved GPS coordinates
        loadPrayersByGPS(localStorage.getItem('lat'), localStorage.getItem('long'));
        
    } else {
        // Case C: First time opening (Default to Makkah)
        loadPrayers("Makkah", "Saudi Arabia");
        document.getElementById('set-city').value = "Makkah";
    }

    /* --- 3. REMOVE BISMILLAH SCREEN --- */
    setTimeout(() => {
        const screen = document.getElementById('bismillah-screen');
        if(screen) {
            screen.style.opacity = '0'; // Fade out
            setTimeout(() => screen.style.display = 'none', 1500); // Remove
        }
    }, 1500); 
});
        // --- THEME LOGIC ---
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const isLight = document.body.classList.contains('light-theme');
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
            const icon = document.querySelector('.theme-toggle i');
            icon.className = isLight ? 'fas fa-moon' : 'fas fa-sun';
        }
        // Load Theme
        if(localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light-theme');
            document.querySelector('.theme-toggle i').className = 'fas fa-moon';
        }

        // --- NAVIGATION LOGIC ---
        function switchTab(tabId, btn) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            if(btn) btn.classList.add('active');
            
            // Lazy Load Features
            if(tabId === 'quran' && document.getElementById('surah-list-view').children.length < 2) loadSurahs();
            if(tabId === 'qibla') updateQiblaUI();
        }

       // --- HOME LOGIC ---
        
        // 1. MASSIVE LIST OF DUAS (ARABIC & ENGLISH)
        const duas = [
            { ar: "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ", en: "Our Lord! Give us in this world that which is good and in the Hereafter that which is good and save us from the torment of the Fire." },
            { ar: "رَبِّ زِدْنِي عِلْمًا", en: "My Lord, increase me in knowledge." },
            { ar: "رَبِّ اشْرَحْ لِي صَدْرِي وَيَسِّرْ لِي أَمْرِي", en: "My Lord, expand for me my breast [with assurance] and ease for me my task." },
            { ar: "رَبَّنَا اغْفِرْ لِي وَلِوَالِدَيَّ وَلِلْمُؤْمِنِينَ يَوْمَ يَقُومُ الْحِسَابُ", en: "Our Lord, forgive me and my parents and the believers the Day the account is established." },
            { ar: "لَا إِلَهَ إِلَّا أَنتَ سُبْحَانَكَ إِنِّي كُنتُ مِنَ الظَّالِمِينَ", en: "There is no deity except You; exalted are You. Indeed, I have been of the wrongdoers." },
            { ar: "رَبَّنَا لَا تُزِغْ قُلُوبَنَا بَعْدَ إِذْ هَدَيْتَنَا وَهَبْ لَنَا مِن لَّدُنكَ رَحْمَةً", en: "Our Lord, let not our hearts deviate after You have guided us and grant us from Yourself mercy." },
            { ar: "رَبِّ إِنِّي لِمَا أَنزَلْتَ إِلَيَّ مِنْ خَيْرٍ فَقِيرٌ", en: "My Lord, indeed I am, for whatever good You would send down to me, in need." },
            { ar: "اللَّهُمَّ إِنَّكَ عَفُوٌّ تُحِبُّ الْعَفْوَ فَاعْفُ عَنِّي", en: "O Allah, You are Forgiving and love forgiveness, so forgive me." },
            { ar: "يَا مُقَلِّبَ الْقُلُوبِ ثَبِّتْ قَلْبِي عَلَى دِينِكَ", en: "O Turner of the hearts, make my heart firm upon Your religion." },
            { ar: "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْهُدَى وَالتُّقَى وَالْعَفَافَ وَالْغِنَى", en: "O Allah, I ask You for guidance, piety, chastity, and self-sufficiency." },
            { ar: "رَبَّنَا هَبْ لَنَا مِنْ أَزْوَاجِنَا وَذُرِّيَّاتِنَا قُرَّةَ أَعْيُنٍ وَاجْعَلْنَا لِلْمُتَّقِينَ إِمَامًا", en: "Our Lord, grant us from among our wives and offspring comfort to our eyes and make us an example for the righteous." },
            { ar: "اللَّهُمَّ اكْفِنِي بِحَلَالِكَ عَنْ حَرَامِكَ وَأَغْنِنِي بِفَضْلِكَ عَمَّنْ سِوَاكَ", en: "O Allah, suffice me with Your lawful against Your prohibited, and make me independent of all those besides You." },
            { ar: "رَبِّ اجْعَلْنِي مُقِيمَ الصَّلَاةِ وَمِن ذُرِّيَّتِي ۚ رَبَّنَا وَتَقَبَّلْ دُعَاءِ", en: "My Lord, make me an establisher of prayer, and [many] from my descendants. Our Lord, and accept my supplication." },
            { ar: "اللَّهُمَّ لَا سَهْلَ إِلَّا مَا جَعَلْتَهُ سَهْلًا، وَأَنْتَ تَجْعَلُ الْحَزْنَ إِذَا شِئْتَ سَهْلًا", en: "O Allah, there is no ease except in that which You have made easy, and You make the difficulty, if You wish, easy." },
            { ar: "رَبِّ أَوْزِعْنِي أَنْ أَشْكُرَ نِعْمَتَكَ الَّتِي أَنْعَمْتَ عَلَيَّ", en: "My Lord, enable me to be grateful for Your favor which You have bestowed upon me." },
            { ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْهَمِّ وَالْحَزَنِ، وَالْعَجْزِ وَالْكَسَلِ", en: "O Allah, I seek refuge in You from anxiety and sorrow, weakness and laziness." },
            { ar: "رَبَّنَا تَقَبَّلْ مِنَّا ۖ إِنَّكَ أَنتَ السَّمِيعُ الْعَلِيمُ", en: "Our Lord, accept [this] from us. Indeed You are the Hearing, the Knowing." },
            { ar: "اللَّهُمَّ صَلِّ عَلَى مُحَمَّدٍ وَعَلَى آلِ مُحَمَّدٍ", en: "O Allah, send prayers upon Muhammad and upon the family of Muhammad." },
            { ar: "حَسْبُنَا اللَّهُ وَنِعْمَ الْوَكِيلُ", en: "Sufficient for us is Allah, and [He is] the best Disposer of affairs." },
            { ar: "رَبَّنَا أَفْرِغْ عَلَيْنَا صَبْرًا وَتَوَفَّنَا مُسْلِمِينَ", en: "Our Lord, pour upon us patience and let us die as Muslims." },
            { ar: "اللَّهُمَّ أَنْتَ رَبِّي لَا إِلَهَ إِلَّا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ", en: "O Allah, You are my Lord, there is no god but You. You created me and I am Your servant (Sayyidul Istighfar)." },
            { ar: "سُبْحَانَ اللَّهِ وَبِحَمْدِهِ سُبْحَانَ اللَّهِ الْعَظِيمِ", en: "Glory be to Allah and His is the praise, (and) Allah, the Greatest is free from imperfection." },
            { ar: "اللَّهُمَّ إِنِّي ظَلَمْتُ نَفْسِي ظُلْمًا كَثِيرًا وَلَا يَغْفِرُ الذُّنُوبَ إِلَّا أَنْتَ", en: "O Allah, I have wronged myself greatly, and no one forgives sins except You." },
            { ar: "رَبَّنَا آمَنَّا فَاغْفِرْ لَنَا وَارْحَمْنَا وَأَنتَ خَيْرُ الرَّاحِمِينَ", en: "Our Lord, we have believed, so forgive us and have mercy upon us, and You are the best of the merciful." },
            { ar: "اللَّهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا وَرِزْقًا طَيِّبًا وَعَمَلًا مُتَقَبَّلًا", en: "O Allah, I ask You for knowledge that is of benefit, a good provision, and deeds that will be accepted." },
            { ar: "رَبِّ ابْنِ لِي عِندَكَ بَيْتًا فِي الْجَنَّةِ", en: "My Lord, build for me near You a house in Paradise." },
            { ar: "اللَّهُمَّ اجْعَلْ فِي قَلْبِي نُورًا وَفِي بَصَرِي نُورًا", en: "O Allah, place light in my heart and light in my sight." },
            { ar: "رَبِّ هَبْ لِي مِنَ الصَّالِحِينَ", en: "My Lord, grant me [a child] from among the righteous." },
            { ar: "رَبَّنَا لَا تُؤَاخِذْنَا إِن نَّسِينَا أَوْ أَخْطَأْنَا", en: "Our Lord, do not impose blame upon us if we have forgotten or erred." },
            { ar: "اللَّهُمَّ عَافِنِي فِي بَدَنِي، اللَّهُمَّ عَافِنِي فِي سَمْعِي، اللَّهُمَّ عَافِنِي فِي بَصَرِي", en: "O Allah, make me healthy in my body. O Allah, make me healthy in my hearing. O Allah, make me healthy in my sight." },
            { ar: "أَعُوذُ بِكَلِمَاتِ اللَّهِ التَّامَّاتِ مِنْ شَرِّ مَا خَلَقَ", en: "I seek refuge in the Perfect Words of Allah from the evil of what He has created." },
            { ar: "بِسْمِ اللَّهِ الَّذِي لَا يَضُرُّ مَعَ اسْمِهِ شَيْءٌ فِي الْأَرْضِ وَلَا فِي السَّمَاءِ", en: "In the Name of Allah, with Whose Name nothing is harmed on earth nor in heaven." },
            { ar: "رَضِيتُ بِاللَّهِ رَبًّا وَبِالْإِسْلَامِ دِينًا وَبِمُحَمَّدٍ نَبِيًّا", en: "I am pleased with Allah as my Lord, with Islam as my religion, and with Muhammad as my Prophet." },
            { ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْكُفْرِ وَالْفَقْرِ", en: "O Allah, I seek refuge in You from disbelief and poverty." },
            { ar: "رَبَّنَا ظَلَمْنَا أَنفُسَنَا وَإِن لَّمْ تَغْفِرْ لَنَا وَتَرْحَمْنَا لَنَكُونَنَّ مِنَ الْخَاسِرِينَ", en: "Our Lord, we have wronged ourselves, and if You do not forgive us and have mercy upon us, we will surely be among the losers." },
            { ar: "اللَّهُمَّ أَعِنِّي عَلَى ذِكْرِكَ وَشُكْرِكَ وَحُسْنِ عِبَادَتِكَ", en: "O Allah, help me to remember You, to give You thanks, and to perform Your worship in the best manner." },
            { ar: "رَبِّ ارْحَمْهُمَا كَمَا رَبَّيَانِي صَغِيرًا", en: "My Lord, have mercy upon them [my parents] as they brought me up [when I was] small." },
            { ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ شَرِّ مَا عَمِلْتُ وَمِنْ شَرِّ مَا لَمْ أَعْمَلْ", en: "O Allah, I seek refuge in You from the evil of what I have done and from the evil of what I have not done." },
            { ar: "اللَّهُمَّ اهْدِنِي فِيمَنْ هَدَيْتَ وَعَافِنِي فِيمَنْ عَافَيْتَ", en: "O Allah, guide me among those whom You have guided, and grant me well-being among those whom You have granted well-being." },
            { ar: "رَبَّنَا أَتْمِمْ لَنَا نُورَنَا وَاغْفِرْ لَنَا ۖ إِنَّكَ عَلَىٰ كُلِّ شَيْءٍ قَدِيرٌ", en: "Our Lord, perfect for us our light and forgive us. Indeed, You are over all things competent." },
            { ar: "لَا حَوْلَ وَلَا قُوَّةَ إِلَّا بِاللَّهِ", en: "There is no power and no strength except with Allah." },
            { ar: "اللَّهُمَّ بَارِكْ لَنَا فِيمَا رَزَقْتَنَا وَقِنَا عَذَابَ النَّارِ", en: "O Allah, bless us in what You have provided for us and save us from the punishment of the Fire." },
            { ar: "سُبْحَانَ الَّذِي سَخَّرَ لَنَا هَذَا وَمَا كُنَّا لَهُ مُقْرِنِينَ", en: "Glory be to Him who has subjected this to us, and we could not have otherwise subdued it." },
            { ar: "اللَّهُمَّ افْتَحْ لِي أَبْوَابَ رَحْمَتِكَ", en: "O Allah, open for me the doors of Your mercy (when entering Mosque)." },
            { ar: "رَبِّ نَجِّنِي مِنَ الْقَوْمِ الظَّالِمِينَ", en: "My Lord, save me from the wrongdoing people." },
            { ar: "الْحَمْدُ لِلَّهِ الَّذِي أَحْيَانَا بَعْدَ مَا أَمَاتَنَا وَإِلَيْهِ النُّشُورُ", en: "Praise is to Allah Who gives us life after He has caused us to die and unto Him is the return." },
            { ar: "اللَّهُمَّ اجْعَلْ خَيْرَ عُمْرِي آخِرَهُ وَخَيْرَ عَمَلِي خَوَاتِمَهُ", en: "O Allah, make the best of my life the end of it, and the best of my deeds the sealing of them." },
            { ar: "اللَّهُمَّ حَاسِبْنِي حِسَابًا يَسِيرًا", en: "O Allah, call me to a difficult account with an easy reckoning." },
            { ar: "رَبِّ أَدْخِلْنِي مُدْخَلَ صِدْقٍ وَأَخْرِجْنِي مُخْرَجَ صِدْقٍ", en: "My Lord, cause me to enter a sound entrance and to exit a sound exit." },
            { ar: "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْجَنَّةَ وَأَعُوذُ بِكَ مِنَ النَّارِ", en: "O Allah, I ask You for Paradise and I seek refuge in You from the Fire." },
            { ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ عِلْمٍ لَا يَنْفَعُ، وَمِنْ قَلْبٍ لَا يَخْشَعُ", en: "O Allah, I seek refuge in You from knowledge which does not benefit and from a heart which does not fear You." },
    { ar: "اللَّهُمَّ أَرِنَا الْحَقَّ حَقًّا وَارْزُقْنَا اتِّبَاعَهُ", en: "O Allah, show us the truth as truth and guide us to follow it." },
    { ar: "يَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ", en: "O Living, O Sustaining! In Your Mercy I seek relief!" },
    { ar: "اللَّهُمَّ أَصْلِحْ لِي شَأْنِي كُلَّهُ وَلَا تَكِلْنِي إِلَى نَفْسِي طَرْفَةَ عَيْنٍ", en: "O Allah, set right all my affairs and do not leave me to myself even for the blink of an eye." },
    { ar: "اللَّهُمَّ إِنِّي أَسْأَلُكَ حُبَّكَ وَحُبَّ مَنْ يُحِبُّكَ", en: "O Allah, I ask You for Your Love and the love of those who love You." },
    { ar: "رَبَّنَا لَا تُزِغْ قُلُوبَنَا بَعْدَ إِذْ هَدَيْتَنَا", en: "Our Lord, let not our hearts deviate after You have guided us." },
    { ar: "اللَّهُمَّ مُصَرِّفَ الْقُلُوبِ صَرِّفْ قُلُوبَنَا عَلَى طَاعَتِكَ", en: "O Turner of the hearts, turn our hearts to Your obedience." },
    { ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ مُنْكَرَاتِ الْأَخْلَاقِ وَالْأَعْمَالِ وَالْأَهْوَاءِ", en: "O Allah, I seek refuge in You from evil character, evil deeds, and evil desires." },
    { ar: "اللَّهُمَّ اغْفِرْ لِي ذَنْبِي كُلَّهُ، دِقَّهُ وَجِلَّهُ، وَأَوَّلَهُ وَآخِرَهُ", en: "O Allah, forgive all my sins, small and great, the first and the last." },
    { ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْكَسَلِ وَالْهَرَمِ وَالْمَأْثَمِ وَالْمَغْرَمِ", en: "O Allah, I seek refuge in You from laziness, old age, sin, and heavy debt." },
    { ar: "اللَّهُمَّ رَبَّ النَّاسِ أَذْهِبِ الْبَاسَ اشْفِهِ وَأَنْتَ الشَّافِي", en: "O Allah, Lord of the people, remove the disease and cure him; You are the Healer." },
    { ar: "بِسْمِ اللَّهِ (3×) أَعُوذُ بِاللَّهِ وَقُدْرَتِهِ مِنْ شَرِّ مَا أَجِدُ وَأُحَاذِرُ (7×)", en: "In the Name of Allah (3x). I seek refuge in Allah and His power from the evil of what I feel and worry about (7x)." },
    { ar: "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْعَافِيَةَ فِي الدُّنْيَا وَالْآخِرَةِ", en: "O Allah, I ask You for well-being in this world and the Hereafter." },
    { ar: "اللَّهُمَّ اسْتُرْ عَوْرَاتِي وَآمِنْ رَوْعَاتِي", en: "O Allah, conceal my faults and calm my fears." },
    { ar: "اللَّهُمَّ احْفَظْنِي مِنْ بَيْنِ يَدَيَّ وَمِنْ خَلْفِي", en: "O Allah, protect me from before me and behind me." },
    { ar: "اللَّهُمَّ أَنْتَ خَلَقْتَ نَفْسِي وَأَنْتَ تَوَفَّاهَا", en: "O Allah, You created my soul and You take it back." },
    { ar: "الْحَمْدُ لِلَّهِ الَّذِي كَسَانِي هَذَا الثَّوْبَ وَرَزَقَنِيهِ", en: "Praise is to Allah Who has clothed me with this garment and provided it for me." },
    { ar: "بِسْمِ اللَّهِ وَلَجْنَا، وَبِسْمِ اللَّهِ خَرَجْنَا", en: "In the Name of Allah we enter, and in the Name of Allah we leave." },
    { ar: "سُبْحَانَكَ اللَّهُمَّ وَبِحَمْدِكَ، أَشْهَدُ أَنْ لَا إِلَهَ إِلَّا أَنْتَ، أَسْتَغْفِرُكَ وَأَتُوبُ إِلَيْكَ", en: "Glory is to You, O Allah, and praise. I bear witness that there is no god but You. I seek Your forgiveness and repent to You." },
    { ar: "اللَّهُمَّ بَاعِدْ بَيْنِي وَبَيْنَ خَطَايَايَ كَمَا بَاعَدْتَ بَيْنَ الْمَشْرِقِ وَالْمَغْرِبِ", en: "O Allah, distance me from my sins as You have distanced the East from the West." },
    { ar: "وَجَّهْتُ وَجْهِيَ لِلَّذِي فَطَرَ السَّمَاوَاتِ وَالْأَرْضَ حَنِيفًا", en: "I have turned my face toward He who created the heavens and the earth, inclining toward truth." },
    { ar: "اللَّهُمَّ لَكَ رَكَعْتُ، وَبِكَ آمَنْتُ، وَلَكَ أَسْلَمْتُ", en: "O Allah, to You I have bowed, in You I have believed, and to You I have submitted." },
    { ar: "سُبْحَانَ رَبِّيَ الْعَظِيمِ", en: "Glory to my Lord the Exalted (in Ruku)." },
    { ar: "سُبْحَانَ رَبِّيَ الْأَعْلَى", en: "Glory to my Lord the Most High (in Sujood)." },
    { ar: "رَبِّ اغْفِرْ لِي، رَبِّ اغْفِرْ لِي", en: "My Lord forgive me, My Lord forgive me." },
    { ar: "التَّحِيَّاتُ لِلَّهِ وَالصَّلَوَاتُ وَالطَّيِّبَاتُ", en: "All compliments, prayers, and pure words are due to Allah (Tashahhud)." },
    { ar: "اللَّهُمَّ صَلِّ عَلَى مُحَمَّدٍ وَعَلَى آلِ مُحَمَّدٍ", en: "O Allah, send prayers upon Muhammad and upon the family of Muhammad." },
    { ar: "اللَّهُمَّ بَارِكْ عَلَى مُحَمَّدٍ وَعَلَى آلِ مُحَمَّدٍ", en: "O Allah, send blessings upon Muhammad and upon the family of Muhammad." },
    { ar: "ذَهَبَ الظَّمَأُ وَابْتَلَّتِ الْعُرُوقُ وَثَبَتَ الْأَجْرُ إِنْ شَاءَ اللَّهُ", en: "The thirst is gone, the veins are quenched, and the reward is confirmed if Allah wills (Iftar)." },
    { ar: "أَفْطَرَ عِنْدَكُمُ الصَّائِمُونَ وَأَكَلَ طَعَامَكُمُ الْأَبْرَارُ", en: "May the fasting break their fast with you, and the pious eat your food (Guest to Host)." },
    { ar: "اللَّهُمَّ بَارِكْ لَهُمْ فِيمَا رَزَقْتَهُمْ، وَاغْفِرْ لَهُمْ وَارْحَمْهُمْ", en: "O Allah, bless them in what You have provided for them, and forgive them and have mercy on them." },
    { ar: "اللَّهُمَّ إِنِّي أَسْأَلُكَ خَيْرَهَا وَخَيْرَ مَا جُبِلَتْ عَلَيْهِ", en: "O Allah, I ask You for the good of her and the good with which You have created her (Marriage)." },
    { ar: "أُعِيذُكُمَا بِكَلِمَاتِ اللَّهِ التَّامَّةِ مِنْ كُلِّ شَيْطَانٍ وَهَامَّةٍ", en: "I seek protection for you in the Perfect Words of Allah from every devil and poisonous reptile (For Children)." },
    { ar: "غُفْرَانَكَ", en: "I ask You (Allah) for forgiveness (Leaving Toilet)." },
    { ar: "الْحَمْدُ لِلَّهِ الَّذِي أَذْهَبَ عَنِّي الْأَذَى وَعَافَانِي", en: "Praise be to Allah who has removed harm from me and kept me in good health." },
    { ar: "اللَّهُمَّ اجْعَلْنِي مِنَ التَّوَّابِينَ وَاجْعَلْنِي مِنَ الْمُتَطَهِّرِينَ", en: "O Allah, make me among those who repent and make me among those who purify themselves." },
    { ar: "اللَّهُمَّ رَبَّ هَذِهِ الدَّعْوَةِ التَّامَّةِ وَالصَّلَاةِ الْقَائِمَةِ", en: "O Allah, Lord of this perfect call and established prayer (After Adhan)." },
    { ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ شَرِّ مَا أُرْسِلَ بِهِ", en: "O Allah, I seek refuge in You from the evil of that with which it was sent (Wind)." },
    { ar: "اللَّهُمَّ صَيِّبًا نَافِعًا", en: "O Allah, may it be a beneficial rain." },
    { ar: "مُطِرْنَا بِفَضْلِ اللَّهِ وَرَحْمَتِهِ", en: "We have been given rain by the grace of Allah and His mercy." },
    { ar: "سُبْحَانَ الَّذِي يُسَبِّحُ الرَّعْدُ بِحَمْدِهِ وَالْمَلَائِكَةُ مِنْ خِيفَتِهِ", en: "Glory to Him whom thunder glorifies with His praise, and the angels from fear of Him." },
    { ar: "اللَّهُمَّ أَهِلَّهُ عَلَيْنَا بِالْأَمْنِ وَالْإِيمَانِ", en: "O Allah, bring it (the crescent moon) over us with safety and faith." },
    { ar: "إِنَّا لِلَّهِ وَإِنَّا إِلَيْهِ رَاجِعُونَ، اللَّهُمَّ أْجُرْنِي فِي مُصِيبَتِي", en: "Indeed we belong to Allah, and indeed to Him we will return. O Allah, reward me in my affliction." },
    { ar: "اللَّهُمَّ لَا سَهْلَ إِلَّا مَا جَعَلْتَهُ سَهْلًا", en: "O Allah, there is no ease except in that which You have made easy." },
    { ar: "يَا مُقَلِّبَ الْقُلُوبِ ثَبِّتْ قَلْبِي عَلَى دِينِكَ", en: "O Turner of the hearts, keep my heart firm on Your religion." },
    { ar: "اللَّهُمَّ اكْفِنِي بِحَلَالِكَ عَنْ حَرَامِكَ", en: "O Allah, suffice me with Your lawful against Your prohibited." },
    { ar: "اللَّهُمَّ اغْفِرْ لِي، وَارْحَمْنِي، وَاهْدِنِي، وَعَافِنِي، وَارْزُقْنِي", en: "O Allah, forgive me, have mercy on me, guide me, grant me health and provide for me." },
    { ar: "أَسْتَغْفِرُ اللَّهَ الَّذِي لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ وَأَتُوبُ إِلَيْهِ", en: "I seek forgiveness of Allah, there is no true god except He, the Living, the Sustaining, and I repent to Him." }
        ];

        // 2. MASSIVE LIST OF GOOD DEEDS
        const deeds = [
            "Smile at a stranger, it's Sunnah.", "Feed a bird or stray animal.", "Call your parents just to say hello.", 
            "Remove a stone or branch from the walking path.", "Give a small amount of charity (Sadaqah).", 
            "Read Ayatul Kursi after Salah.", "Recite Surah Al-Ikhlas 3 times (Equivalent to 1/3 Quran).", 
            "Forgive someone who upset you.", "Make a sincere Dua for a friend in private.", 
            "Visit a sick person.", "Bring a glass of water to someone.", "Hold the door open for someone.",
            "Say 'SubhanAllah' 33 times.", "Say 'Alhamdulillah' 33 times.", "Say 'Allahu Akbar' 34 times before sleep.",
            "Read one page of the Quran with meaning.", "Teach someone a beneficial thing.", "Share your food with a neighbor.",
            "Do not get angry today.", "Lower your gaze.", "Greet someone with 'As-salamu alaykum'.", 
            "Wake up 15 minutes early for Tahajjud.", "Make wudu before going to sleep.", 
            "Listen to your mother/father without interrupting.", "Clean up a mess you didn't make.", 
            "Donate old clothes to the needy.", "Say 'Astaghfirullah' 100 times.", "Walk to the Masjid for Salah.",
            "Comfort someone who is sad.", "Avoid backbiting (Gheebah) for the whole day.", "Send Salawat upon the Prophet (ﷺ) 10 times.",
            "Drink water while sitting down.", "Enter the house with your right foot.", "Say 'Bismillah' before eating.",
            "Plant a tree or water a plant.", "Help your family with house chores.", "Write a thank you note to someone.",
            "Stop using your phone 30 mins before bed.", "Make Dua for the suffering Ummah.", "Give a date (fruit) to a fasting person.",
            "Speak gently to everyone today.", "Leave a nice comment on something.", "Think good of others (Husn al-Zann).",
            "Review a Surah you memorized.", "Pray Salatul Duha (Forenoon prayer).", "Be patient when stuck in traffic.",
            "Say 'La hawla wa la quwwata illa billah'.", "Thank Allah for 5 specific blessings.", "Help someone carry their bags.",
            "Turn off lights to save energy (Israf).", "Control your tongue when upset.", "Hide a good deed so only Allah knows it.",
            "Recite the last 2 verses of Surah Baqarah at night.", "Make Dua for your teachers/scholars.", 
            "Give precedence to others in line.", "Keep your promise.", "Do not complain about the food.",
            "Kiss your mother's hand or head.", "Encourage someone to do good.", "Reflect on the creation of the heavens.",
            "Recite Surah Kahf (if it is Friday).", "Wear your best clothes for Jumu'ah.", "Use the Miswak.",
            "Make Ghusl on Friday.", "Avoid arguing even if you are right.", "Sponsor an orphan if you can.",
            "Leave a bowl of water for birds.", "Smile at your sibling.", "Say 'Alhamdulillah' after sneezing.",
            "Reply to a sneeze with 'YarhamukAllah'.", "Cover a fault of a Muslim.", "Defend someone who is being insulted.",
            "Give a gift to someone you love.", "Be punctual for appointments.", "Fulfill a trust (Amanah).",
            "Be kind to a neighbor.", "Make Dua for those who passed away.", "Memorize a new Dua.",
            "Stay silent during the Adhan and repeat after it.", "Make Dua between Adhan and Iqamah.", 
            "Sit in the Masjid after Fajr until sunrise.", "Fast a Monday or Thursday.", "Fast the White Days (13, 14, 15).",
            "Pray the Rawatib (Sunnah prayers).", "Attend a funeral prayer (Janazah).", "Follow a funeral procession.",
            "Give water to a thirsty person.", "Guide someone who is lost.", "Help a coworker or classmate.",
            "Clean the Masjid area.", "Place a copy of Quran in a Masjid (Waqf).", "Share beneficial knowledge online.",
            "Delete a sin/bad post from your social media.", "Unsubscribe from harmful content.", "Say 'JazakAllah Khair' to someone.",
            "Respect the elderly.", "Show mercy to the young.", "Be honest in your dealings.",
            "Pay someone their due before their sweat dries.", "Do not waste water while doing Wudu.", 
            "Sleep on your right side.", "Dust your bed before sleeping.",
            "Help someone learn a new Dua.",
    "Share a meal with a coworker or friend.",
    "Make Dua for the people of Palestine and the oppressed.",
    "Hold the elevator for someone rushing.",
    "Let a car merge in front of you in traffic.",
    "Compliment a stranger's character or manners.",
    "Pick up litter in your local park.",
    "Do not complain about the weather today.",
    "Listen to the Quran while commuting.",
    "Teach a child how to say 'Bismillah'.",
    "Avoid using plastic cups/plates today to protect the earth.",
    "Forgive a debt if you are able to."
        ];

      /* --- COMPLETE 99 NAMES DATABASE WITH DUAS --- */
const names = [
    { ar: "ٱللَّٰهُ", en: "Allah", meaning: "The God", dua: "Ya Allah, I ask You by Your Name that is comprehensive of all names, guide me to what pleases You and keep me steadfast on Your path." },
    { ar: "ٱلرَّحْمَٰنُ", en: "Ar-Rahman", meaning: "The Most Gracious", dua: "Ya Rahman, Your mercy encompasses all things. Encompass me, my family, and the Ummah in Your infinite mercy today." },
    { ar: "ٱلرَّحِيمُ", en: "Ar-Rahim", meaning: "The Most Merciful", dua: "Ya Rahim, have mercy on my weak soul. Forgive my shortcomings and grant me a station of nearness to You." },
    { ar: "ٱلْمَلِكُ", en: "Al-Malik", meaning: "The King", dua: "Ya Malik, You are the Owner of all affairs. I leave my worries in Your Kingdom; manage my life better than I can manage it myself." },
    { ar: "ٱلْقُدُّوسُ", en: "Al-Quddus", meaning: "The Most Holy", dua: "Ya Quddus, purify my heart from arrogance, my tongue from lying, and my eyes from seeing what is forbidden." },
    { ar: "ٱلسَّلَامُ", en: "As-Salam", meaning: "The Source of Peace", dua: "Ya Salam, grant peace to my anxious heart. Protect me from the storms of life and grant me a peaceful end." },
    { ar: "ٱلْمُؤْمِنُ", en: "Al-Mu'min", meaning: "The Granter of Security", dua: "Ya Mu'min, grant me safety in my faith and security in my life. Protect me from the fear of creation." },
    { ar: "ٱلْمُهَيْمِنُ", en: "Al-Muhaymin", meaning: "The Guardian", dua: "Ya Muhaymin, be the witness over my actions and the Guardian over my family. Do not leave me to myself for even a blink of an eye." },
    { ar: "ٱلْعَزِيزُ", en: "Al-Aziz", meaning: "The Almighty", dua: "Ya Aziz, grant me honor through obedience to You. Do not let me be humiliated by my sins or by begging from others." },
    { ar: "ٱلْجَبَّارُ", en: "Al-Jabbar", meaning: "The Compeller / Mender", dua: "Ya Jabbar, mend my broken heart and fix my broken affairs. Restore me in a way that only You can." },
    { ar: "ٱلْمُتَكَبِّرُ", en: "Al-Mutakabbir", meaning: "The Supreme", dua: "Ya Mutakabbir, humble my ego. Remind me that all greatness belongs to You, and I am but Your servant." },
    { ar: "ٱلْخَالِقُ", en: "Al-Khaliq", meaning: "The Creator", dua: "Ya Khaliq, You created me from nothing. Create for me a way out of my difficulties and create light in my heart." },
    { ar: "ٱلْبَارِئُ", en: "Al-Bari", meaning: "The Evolver", dua: "Ya Bari, heal my body and soul. Restore my health and guide me to use my strength in Your worship." },
    { ar: "ٱلْمُصَوِّرُ", en: "Al-Musawwir", meaning: "The Fashioner", dua: "Ya Musawwir, beautify my character as You have beautified my creation. Let my inner appearance be pleasing to You." },
    { ar: "ٱلْغَفَّارُ", en: "Al-Ghaffar", meaning: "The Constant Forgiver", dua: "Ya Ghaffar, my sins are many but Your mercy is limitless. Forgive my past, purify my present, and protect my future." },
    { ar: "ٱلْقَهَّارُ", en: "Al-Qahhar", meaning: "The Subduer", dua: "Ya Qahhar, subdue my lower self (Nafs) and help me conquer my bad habits. Let nothing overpower my love for You." },
    { ar: "ٱلْوَهَّابُ", en: "Al-Wahhab", meaning: "The Bestower", dua: "Ya Wahhab, give me from Your treasures that which never runs out. Grant me wisdom, gratitude, and a righteous family." },
    { ar: "ٱلرَّزَّاقُ", en: "Ar-Razzaq", meaning: "The Provider", dua: "Ya Razzaq, bless my earnings with Barakah. Make me independent of your creation and dependent only on You." },
    { ar: "ٱلْفَتَّاحُ", en: "Al-Fattah", meaning: "The Opener", dua: "Ya Fattah, open for me the doors of Your mercy, sustenance, and guidance. Remove the blockages in my life that I cannot see." },
    { ar: "ٱلْعَلِيمُ", en: "Al-Alim", meaning: "The All-Knowing", dua: "Ya Alim, You know my pain and my needs. Grant me beneficial knowledge that brings me closer to You." },
    { ar: "ٱلْقَابِضُ", en: "Al-Qabid", meaning: "The Withholder", dua: "Ya Qabid, withhold evil from reaching me. Keep my heart focused and do not let it wander to what harms it." },
    { ar: "ٱلْبَاسِطُ", en: "Al-Basit", meaning: "The Extender", dua: "Ya Basit, expand my chest with relief and extend my sustenance. Fill my life with the vastness of Your grace." },
    { ar: "ٱلْخَافِضُ", en: "Al-Khafid", meaning: "The Abaser", dua: "Ya Khafid, protect me from arrogance. Let me lower my wing of humility to my parents and the believers." },
    { ar: "ٱلرَّافِعُ", en: "Ar-Rafi", meaning: "The Exalter", dua: "Ya Rafi, raise my rank in Jannah and raise me in the eyes of the people through my character, not my wealth." },
    { ar: "ٱلْمُعِزُّ", en: "Al-Mu'izz", meaning: "The Giver of Honour", dua: "Ya Mu'izz, honor me with Islam and Iman. Let me find dignity in servitude to You alone." },
    { ar: "ٱلْمُذِلُّ", en: "Al-Mudhill", meaning: "The Giver of Dishonour", dua: "Ya Mudhill, protect me from the disgrace of sin and the humiliation of begging from Your creation." },
    { ar: "ٱلسَّمِيعُ", en: "As-Sami", meaning: "The All-Hearing", dua: "Ya Sami, You hear the whisper of my heart. Hear my Dua and accept it, for I have no one else to call upon." },
    { ar: "ٱلْبَصِيرُ", en: "Al-Basir", meaning: "The All-Seeing", dua: "Ya Basir, You see my struggles when no one else does. Watch over me and guide my steps." },
    { ar: "ٱلْحَكَمُ", en: "Al-Hakam", meaning: "The Judge", dua: "Ya Hakam, judge me with Your mercy, not Your justice. Protect me from injustice and make me just with others." },
    { ar: "ٱلْعَدْلُ", en: "Al-Adl", meaning: "The Just", dua: "Ya Adl, help me be fair in my dealings. Establish justice in my heart and in the world around me." },
    { ar: "ٱللَّطِيفُ", en: "Al-Latif", meaning: "The Subtle One", dua: "Ya Latif, be kind to me in my destiny. Save me from difficulties in ways I cannot even imagine." },
    { ar: "ٱلْخَبِيرُ", en: "Al-Khabir", meaning: "The All-Aware", dua: "Ya Khabir, You know the secrets of my soul. Guide me to correct my hidden faults before they destroy me." },
    { ar: "ٱلْحَلِيمُ", en: "Al-Halim", meaning: "The Forbearing", dua: "Ya Halim, do not punish me immediately for my mistakes. Give me the chance to repent and return to You." },
    { ar: "ٱلْعَظِيمُ", en: "Al-Azim", meaning: "The Magnificent", dua: "Ya Azim, make my problems seem small in light of Your Greatness. Fill my heart with awe of You." },
    { ar: "ٱلْغَفُورُ", en: "Al-Ghafur", meaning: "The Forgiving", dua: "Ya Ghafur, wipe away my sins as if they never happened. Let me meet You with a clean book of deeds." },
    { ar: "ٱلشَّكُورُ", en: "Ash-Shakur", meaning: "The Appreciative", dua: "Ya Shakur, help me to be grateful for the smallest blessings. Accept my small deeds and multiply them." },
    { ar: "ٱلْعَلِيُّ", en: "Al-Ali", meaning: "The Most High", dua: "Ya Ali, raise my aspirations to the Hereafter. Do not let me settle for the lowliness of this world." },
    { ar: "ٱلْكَبِيرُ", en: "Al-Kabir", meaning: "The Great", dua: "Ya Kabir, You are greater than any obstacle I face. Give me the strength to overcome my challenges." },
    { ar: "ٱلْحَفِيظُ", en: "Al-Hafiz", meaning: "The Preserver", dua: "Ya Hafiz, protect my faith, my family, and my health. Save me from the evil of envy and the whispers of Shaytan." },
    { ar: "ٱلْمُقِيتُ", en: "Al-Muqit", meaning: "The Sustainer", dua: "Ya Muqit, nourish my body with Halal and my soul with remembrance. You are sufficient for all my needs." },
    { ar: "ٱلْحَسِيبُ", en: "Al-Hasib", meaning: "The Reckoner", dua: "Ya Hasib, make my reckoning easy on the Day of Judgment. Suffice me in all my affairs." },
    { ar: "ٱلْجَلِيلُ", en: "Al-Jalil", meaning: "The Majestic", dua: "Ya Jalil, let the majesty of Your Face be the light of my life. Fill my heart with reverence for You." },
    { ar: "ٱلْكَرِيمُ", en: "Al-Karim", meaning: "The Generous", dua: "Ya Karim, Your generosity knows no bounds. Be generous with me in Your forgiveness and Your provision." },
    { ar: "ٱلرَّقِيبُ", en: "Ar-Raqib", meaning: "The Watchful", dua: "Ya Raqib, help me to be mindful of You in private and in public. Let me fear no one but You." },
    { ar: "ٱلْمُجِيبُ", en: "Al-Mujib", meaning: "The Responsive", dua: "Ya Mujib, answer my prayers even if I am unworthy. You are the One who never rejects a sincere caller." },
    { ar: "ٱلْوَاسِعُ", en: "Al-Wasi", meaning: "The All-Encompassing", dua: "Ya Wasi, expand my heart to contain the truth. Grant me vastness in my sustenance and my patience." },
    { ar: "ٱلْحَكِيمُ", en: "Al-Hakim", meaning: "The Wise", dua: "Ya Hakim, I trust Your plan even when it hurts. Grant me the wisdom to see the good in every situation." },
    { ar: "ٱلْوَدُودُ", en: "Al-Wadud", meaning: "The Most Loving", dua: "Ya Wadud, fill my heart with Your love and the love of those who love You. Let me be a source of love to others." },
    { ar: "ٱلْمَجِيدُ", en: "Al-Majid", meaning: "The Glorious", dua: "Ya Majid, to You belongs all glory. Grant me a righteous reputation and accept my deeds." },
    { ar: "ٱلْبَاعِثُ", en: "Al-Ba'ith", meaning: "The Resurrector", dua: "Ya Ba'ith, revive my dead heart with Iman. Raise me with the Prophets and the Righteous on the Last Day." },
    { ar: "ٱلشَّهِيدُ", en: "Ash-Shahid", meaning: "The Witness", dua: "Ya Shahid, You witness my struggles and my pain. Be a witness for me, not against me, on the Day of Judgment." },
    { ar: "ٱلْحَقُّ", en: "Al-Haqq", meaning: "The Truth", dua: "Ya Haqq, guide me to the truth and help me stand by it. Let me not be deceived by the illusions of this world." },
    { ar: "ٱلْوَكِيلُ", en: "Al-Wakil", meaning: "The Trustee", dua: "Ya Wakil, I entrust my worry, my family, and my future to You. You are the best disposer of affairs." },
    { ar: "ٱلْقَوِيُّ", en: "Al-Qawiyy", meaning: "The Strong", dua: "Ya Qawiyy, give me strength to worship You and strength to resist temptation. I am weak without Your help." },
    { ar: "ٱلْمَتِينُ", en: "Al-Matin", meaning: "The Firm", dua: "Ya Matin, make my faith firm and unshakeable. Do not let trials cause me to waver." },
    { ar: "ٱلْوَلِيُّ", en: "Al-Wali", meaning: "The Protecting Friend", dua: "Ya Wali, be my Friend in this life and the next. Take me out of the darkness into Your Light." },
    { ar: "ٱلْحَمِيدُ", en: "Al-Hamid", meaning: "The Praiseworthy", dua: "Ya Hamid, all praise belongs to You in every situation. Help me to praise You in ease and in hardship." },
    { ar: "ٱلْمُحْصِي", en: "Al-Muhsi", meaning: "The Counter", dua: "Ya Muhsi, You count every breath and every deed. Let my good deeds outweigh my bad deeds." },
    { ar: "ٱلْمُبْدِئُ", en: "Al-Mubdi", meaning: "The Originator", dua: "Ya Mubdi, You started my life with mercy, so complete it with forgiveness. Guide me to new beginnings in obedience." },
    { ar: "ٱلْمُعِيدُ", en: "Al-Mu'id", meaning: "The Restorer", dua: "Ya Mu'id, restore what I have lost and restore my heart to its purity. Bring me back to You whenever I stray." },
    { ar: "ٱلْمُحْيِي", en: "Al-Muhyi", meaning: "The Giver of Life", dua: "Ya Muhyi, give life to my heart with the Quran. Grant me a good life in this world and the Hereafter." },
    { ar: "ٱلْمُمِيتُ", en: "Al-Mumit", meaning: "The Taker of Life", dua: "Ya Mumit, let me die only when You are pleased with me. Protect me from a sudden or evil death." },
    { ar: "ٱلْحَيُّ", en: "Al-Hayy", meaning: "The Living", dua: "Ya Hayy, by Your mercy I seek assistance. Set right all my affairs and do not leave me to myself." },
    { ar: "ٱلْقَيُّومُ", en: "Al-Qayyum", meaning: "The Subsisting", dua: "Ya Qayyum, You sustain all existence. Sustain me with Halal provision and keep me steadfast." },
    { ar: "ٱلْوَاجِدُ", en: "Al-Wajid", meaning: "The Finder", dua: "Ya Wajid, let me find joy in Your worship. Do not let me lose my way in the distractions of this life." },
    { ar: "ٱلْمَاجِدُ", en: "Al-Majid", meaning: "The Noble", dua: "Ya Majid, grant me noble character and high aspirations. Let me live for something greater than myself." },
    { ar: "ٱلْوَاحِدُ", en: "Al-Wahid", meaning: "The One", dua: "Ya Wahid, You are One and Unique. Keep my heart attached to You alone, free from associating partners with You." },
    { ar: "ٱلْأَحَد", en: "Al-Ahad", meaning: "The Absolute One", dua: "Ya Ahad, You are my only hope. I turn to You alone for my needs, for You have no equal." },
    { ar: "ٱلصَّمَدُ", en: "As-Samad", meaning: "The Eternal", dua: "Ya Samad, everyone needs You and You need no one. Fulfill my needs and make me independent of Your creation." },
    { ar: "ٱلْقَادِرُ", en: "Al-Qadir", meaning: "The Capable", dua: "Ya Qadir, You are capable of all things. Make me capable of obeying You and staying away from sin." },
    { ar: "ٱلْمُقْتَدِرُ", en: "Al-Muqtadir", meaning: "The Powerful", dua: "Ya Muqtadir, use Your power to support the oppressed and guide me to use my power for good." },
    { ar: "ٱلْمُقَدِّمُ", en: "Al-Muqaddim", meaning: "The Expediter", dua: "Ya Muqaddim, bring forward the good in my life and hasten the relief for my difficulties." },
    { ar: "ٱلْمُؤَخِّرُ", en: "Al-Mu'akhkhir", meaning: "The Delayer", dua: "Ya Mu'akhkhir, delay my punishment and give me time to repent. Keep evil far away from me." },
    { ar: "ٱلْأَوَّلُ", en: "Al-Awwal", meaning: "The First", dua: "Ya Awwal, let my first thought be of You. Make my beginning good and my end even better." },
    { ar: "ٱلْآخِرُ", en: "Al-Akhir", meaning: "The Last", dua: "Ya Akhir, remain with me when everyone else leaves. Let my last words in this life be La ilaha illallah." },
    { ar: "ٱلظَّاهِرُ", en: "Az-Zahir", meaning: "The Manifest", dua: "Ya Zahir, make the truth clear to me and help me follow it. Let Your signs be visible in everything I see." },
    { ar: "ٱلْبَاطِنُ", en: "Al-Batin", meaning: "The Hidden", dua: "Ya Batin, purify my inner self. Let my private worship be better than my public worship." },
    { ar: "ٱلْوَالِي", en: "Al-Wali", meaning: "The Governor", dua: "Ya Wali, govern my heart and my affairs. Do not leave me to the governance of my own ego." },
    { ar: "ٱلْمُتَعَالِي", en: "Al-Muta'ali", meaning: "The Most Exalted", dua: "Ya Muta'ali, elevate me through humility. Let me never be arrogant or look down on Your creation." },
    { ar: "ٱلْبَرُّ", en: "Al-Barr", meaning: "The Source of Good", dua: "Ya Barr, You are the source of all kindness. Be kind to my parents and forgive them as they raised me when I was small." },
    { ar: "ٱلتَّوَّابُ", en: "At-Tawwab", meaning: "The Acceptor of Repentance", dua: "Ya Tawwab, accept my repentance and cleanse me. Make me among those who constantly turn back to You." },
    { ar: "ٱلْمُنْتَقِمُ", en: "Al-Muntaqim", meaning: "The Avenger", dua: "Ya Muntaqim, I leave my rights in Your hands. Vindicate me against those who wronged me, without me becoming unjust." },
    { ar: "ٱلْعَفُوُّ", en: "Al-Afuww", meaning: "The Pardoner", dua: "Ya Afuww, You love to pardon, so pardon me. Erase my sins completely and do not question me about them." },
    { ar: "ٱلرَّءُوفُ", en: "Ar-Ra'uf", meaning: "The Kind", dua: "Ya Ra'uf, soften my heart towards Your creation. Treat me with Your gentleness on the Day of Fear." },
    { ar: "مَالِكُ ٱلْمُلْكِ", en: "Malik-ul-Mulk", meaning: "Owner of Sovereignty", dua: "Ya Malik-ul-Mulk, You give power to whom You will. Grant me authority over my own desires." },
    { ar: "ذُو ٱلْجَلَالِ وَٱلْإِكْرَامِ", en: "Dhul-Jalal wal-Ikram", meaning: "Lord of Majesty and Generosity", dua: "Ya Dhul-Jalal wal-Ikram, I ask You by this great Name to grant me success in this life and Paradise in the next." },
    { ar: "ٱلْمُقْسِطُ", en: "Al-Muqsit", meaning: "The Equitable", dua: "Ya Muqsit, make me just in my anger and my happiness. Save me from oppressing anyone." },
    { ar: "ٱلْجَامِعُ", en: "Al-Jami", meaning: "The Gatherer", dua: "Ya Jami, gather me with the righteous in Jannah. Unite the hearts of my family and the Ummah." },
    { ar: "ٱلْغَنِيُّ", en: "Al-Ghani", meaning: "The Rich", dua: "Ya Ghani, enrich my soul with contentment. Let me never feel poor as long as I have You." },
    { ar: "ٱلْمُغْنِي", en: "Al-Mughni", meaning: "The Enricher", dua: "Ya Mughni, grant me wealth that I can use in Your path. Enrich me with faith and good character." },
    { ar: "ٱلْمَانِعُ", en: "Al-Mani", meaning: "The Withholder", dua: "Ya Mani, prevent harm from reaching me and my family. Protect me from sins and bad company." },
    { ar: "ٱلضَّارُّ", en: "Ad-Darr", meaning: "The Distressor", dua: "Ya Darr, I know no harm touches me except by Your permission. Make every trial a means of purification for me." },
    { ar: "ٱلنَّافِعُ", en: "An-Nafi", meaning: "The Benefactor", dua: "Ya Nafi, make me a source of benefit to others. Let my life be a means of goodness for everyone I meet." },
    { ar: "ٱلنُّورُ", en: "An-Nur", meaning: "The Light", dua: "Ya Nur, guide me with Your Light. Place light in my heart, my grave, and on my path across the Sirat." },
    { ar: "ٱلْهَادِي", en: "Al-Hadi", meaning: "The Guide", dua: "Ya Hadi, guide me to the Straight Path and keep me on it until I meet You." },
    { ar: "ٱلْبَدِيعُ", en: "Al-Badi", meaning: "The Originator", dua: "Ya Badi, grant me a beautiful patience and a beautiful exit from this world." },
    { ar: "ٱلْبَاقِي", en: "Al-Baqi", meaning: "The Everlasting", dua: "Ya Baqi, everything will perish except You. Attach my heart to the Everlasting Akhirah, not this temporary world." },
    { ar: "ٱلْوَارِثُ", en: "Al-Warith", meaning: "The Inheritor", dua: "Ya Warith, make me an inheritor of Jannatul Firdaus. Let me leave behind a legacy of good deeds." },
    { ar: "ٱلرَّشِيدُ", en: "Ar-Rashid", meaning: "The Guide to Right Path", dua: "Ya Rashid, inspire me to make the right decisions. Save me from confusion and regret." },
    { ar: "ٱلصَّبُورُ", en: "As-Sabur", meaning: "The Patient", dua: "Ya Sabur, pour patience upon me. Help me to endure the tests of life with grace and trust in You." }
];

function generateName() {
    // Pick Random Name (Or rotate by day)
    const data = names[Math.floor(Math.random() * names.length)];
    
    document.getElementById('name-ar').innerText = data.ar;
    document.getElementById('name-en').innerText = data.en;
    document.getElementById('name-meaning').innerText = data.meaning;
    document.getElementById('name-dua').innerText = `"${data.dua}"`;
}

function toggleNameDua() {
    const box = document.getElementById('name-dua-box');
    const btn = document.querySelector('button[onclick="toggleNameDua()"]');
    
    if (box.style.display === 'none') {
        box.style.display = 'block';
        btn.innerHTML = '<i class="fas fa-chevron-up"></i> Close';
        btn.style.background = 'rgba(251, 191, 36, 0.2)'; // Gold tint
    } else {
        box.style.display = 'none';
        btn.innerHTML = '<i class="fas fa-hands-praying"></i> How to Ask';
        btn.style.background = 'rgba(255,255,255,0.1)';
    }
}

        // --- GENERATE RANDOM CONTENT ---
        function generateDailyContent() {
            // Pick a random Dua based on the date to rotate them, or random
            const today = new Date().getDate();
            
            // Random Deed
            const randomDeed = deeds[Math.floor(Math.random() * deeds.length)];
            document.getElementById('deed-text').innerText = randomDeed;

            // Daily Dua (Rotates daily based on date so it doesn't change on refresh)
            const duaIndex = today % duas.length;
            const dailyDua = duas[duaIndex];
            
            document.getElementById('dua-ar').innerText = dailyDua.ar;
            document.getElementById('dua-en').innerText = dailyDua.en;
            generateName();
        }
        function newDeed() {
            const randomDeed = deeds[Math.floor(Math.random() * deeds.length)];
            const textElement = document.getElementById('deed-text');
            
            // simple fade effect
            textElement.style.opacity = 0;
            setTimeout(() => {
                textElement.innerText = randomDeed;
                textElement.style.opacity = 1;
            }, 300);
             
        
        }

        // Call the generator
        generateDailyContent();

        // 3. SETTINGS & PRAYER LOGIC... (Keep the rest of your code below this)

        // --- SETTINGS & PRAYER LOGIC ---
        function saveSettings() {
            const city = document.getElementById('set-city').value;
            const country = document.getElementById('set-country').value;
            if(city) {
                localStorage.setItem('city', city);
                localStorage.setItem('country', country);
                document.getElementById('save-msg').style.display = 'block';
                setTimeout(() => document.getElementById('save-msg').style.display = 'none', 2000);
                loadPrayers(city, country);
            }
        }

        /* --- 1. SPECIAL EVENTS LOGIC (Hijri Check) --- */
function checkSpecialEvents(hijriData) {
    const day = parseInt(hijriData.day);
    const month = parseInt(hijriData.month.number); 
    const greetingEl = document.querySelector('.greeting'); 

    let eventName = "";

    // Sunni Tradition Significant Dates
    if (month === 1 && day === 10) eventName = "Yawm al-Ashura";
    else if (month === 9) eventName = "Ramadan Mubarak";
    else if (month === 10 && day === 1) eventName = "Eid al-Fitr";
    else if (month === 12 && day === 9) eventName = "Day of Arafah";
    else if (month === 12 && day === 10) eventName = "Eid al-Adha";
    else if (month === 8 && day === 15) eventName = "Laylatul Bara'ah"; 
    else if (month === 7 && day === 27) eventName = "Isra wal Mi'raj"; 

    // Update the greeting if it's a special day
    if (eventName && greetingEl) {
        greetingEl.innerText = eventName;
        greetingEl.style.color = "var(--brand-gold)";
        greetingEl.style.textShadow = "0 0 20px var(--brand-gold-glow)";
    }
}

/* --- 2. CENTRAL UI UPDATER (Used by both GPS and Search) --- */
function updatePrayerUI(timings, hijri) {
    const container = document.getElementById('prayer-list-render');
    
    // Start the countdown
    startCountdown(timings);
    
    // Update Date & Check Events
    if(hijri && document.getElementById('hijri-date')) {
        document.getElementById('hijri-date').innerText = `${hijri.day} ${hijri.month.en} ${hijri.year}`;
        checkSpecialEvents(hijri);
    }
    
    // Render the list
    if(container) {
        container.innerHTML = `
            <div class="prayer-row"><span>Fajr</span><span>${timings.Fajr}</span></div>
            <div class="prayer-row"><span>Dhuhr</span><span>${timings.Dhuhr}</span></div>
            <div class="prayer-row"><span>Asr</span><span>${timings.Asr}</span></div>
            <div class="prayer-row"><span>Maghrib</span><span>${timings.Maghrib}</span></div>
            <div class="prayer-row"><span>Isha</span><span>${timings.Isha}</span></div>
        `;
    }
}

async function loadPrayers(city, country) {
    const container = document.getElementById('prayer-list-render');
    container.innerHTML = '<div class="spinner"></div>';
    
    try {
        const res = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=2`);
        if (!res.ok) throw new Error("Network error");
        
        const data = await res.json();
        const t = data.data.timings;
        
        document.getElementById('active-city-label').innerText = city;
        
        // *** THIS IS THE KEY CHANGE ***
        updatePrayerUI(t, data.data.date.hijri); 
        // ******************************

        // Save for Qibla
        localStorage.setItem('lat', data.data.meta.latitude);
        localStorage.setItem('long', data.data.meta.longitude);

    } catch(e) { 
        container.innerHTML = "Error loading. Check City Name."; 
    }
}
        
        // Initial Load
        const userCity = localStorage.getItem('city');
        if(userCity) {
            document.getElementById('set-city').value = userCity;
            loadPrayers(userCity, localStorage.getItem('country') || "");
        }

        // --- QIBLA LOGIC ---
        function updateQiblaUI() {
            const lat = parseFloat(localStorage.getItem('lat'));
            const long = parseFloat(localStorage.getItem('long'));
            const city = localStorage.getItem('city');
            
            if(city) document.getElementById('qibla-city-label').innerText = city;

            if(lat && long) {
                const kaabaLat = 21.4225 * (Math.PI/180);
                const kaabaLong = 39.8262 * (Math.PI/180);
                const userLat = lat * (Math.PI/180);
                const userLong = long * (Math.PI/180);
                
                const y = Math.sin(kaabaLong - userLong);
                const x = Math.cos(userLat) * Math.tan(kaabaLat) - Math.sin(userLat) * Math.cos(kaabaLong - userLong);
                let dir = (Math.atan2(y, x) * 180 / Math.PI + 360) % 360;
                
                document.getElementById('qibla-deg').innerText = Math.round(dir) + "°";
                document.querySelector('.kaaba-pointer').style.transform = `rotate(${dir}deg)`;
            }
        }

        // --- QURAN LOGIC ---
        /* --- OPTIMIZED SURAH LIST (Caches Forever) --- */
async function loadSurahs() {
    const list = document.getElementById('surah-list-view');
    
    // 1. CHECK CACHE
    const savedSurahs = localStorage.getItem('quran_surah_list');
    if (savedSurahs) {
        renderSurahList(JSON.parse(savedSurahs));
        return;
    }

    // 2. FETCH NEW
    try {
        const res = await fetch('https://api.alquran.cloud/v1/surah');
        const data = await res.json();
        
        // 3. SAVE CACHE
        localStorage.setItem('quran_surah_list', JSON.stringify(data.data));
        renderSurahList(data.data);
        
    } catch(e) { 
        list.innerHTML = "Error loading list."; 
    }
}

function renderSurahList(surahs) {
    const list = document.getElementById('surah-list-view');
    list.innerHTML = '';
    surahs.forEach(s => {
        const item = document.createElement('div');
        item.className = 'surah-item';
        item.innerHTML = `
            <div style="display:flex;align-items:center;gap:10px;">
                <div class="surah-num">${s.number}</div>
                <div>
                    <b>${s.englishName}</b>
                    <div style="font-size:0.8rem;color:var(--text-secondary)">${s.englishNameTranslation}</div>
                </div>
            </div>
            <div style="font-family:'Amiri';color:var(--brand-gold)">${s.name}</div>`;
        item.onclick = () => readSurah(s.number, s.englishName);
        list.appendChild(item);
    });
}
       /* --- OPTIMIZED SURAH READER (Caches Content) --- */
async function readSurah(num, name) {
    // 1. Switch View immediately
    document.getElementById('surah-list-view').style.display = 'none';
    document.getElementById('surah-read-view').style.display = 'block';
    document.getElementById('read-title').innerText = name;
    
    const container = document.getElementById('ayah-container');
    container.innerHTML = '<div class="spinner"></div>';
    
    // 2. CHECK CACHE: Do we already have this Surah saved?
    const cacheKey = `surah_content_${num}`;
    const cachedData = localStorage.getItem(cacheKey);

    if (cachedData) {
        renderSurahContent(JSON.parse(cachedData));
        return; // Stop here, instant load!
    }

    // 3. FETCH NEW (If not in cache)
    try {
        const res = await fetch(`https://api.alquran.cloud/v1/surah/${num}/editions/quran-uthmani,en.asad`);
        const data = await res.json();
        
        // 4. SAVE TO CACHE (Try/Catch in case memory is full)
        try {
            localStorage.setItem(cacheKey, JSON.stringify(data));
        } catch (e) {
            console.warn("Phone memory full, couldn't save Surah offline.");
        }

        renderSurahContent(data);
        
    } catch(e) {
        container.innerHTML = `<p style="text-align:center; color:var(--brand-gold)">
            Error loading Surah. Please check your internet.
        </p>`;
    }
}

// Helper to render the text (Used by both Cache and API)
function renderSurahContent(data) {
    const ar = data.data[0].ayahs;
    const en = data.data[1].ayahs;
    const container = document.getElementById('ayah-container');
    
    let html = '';
    // Loop through Ayahs
    ar.forEach((ayah, i) => {
        html += `
        <div class="ayah-box">
            <p class="ayah-arabic">${ayah.text}</p>
            <p class="ayah-trans">
                <span style="color:var(--brand-gold);font-weight:bold;">${ayah.numberInSurah}.</span> 
                ${en[i].text}
            </p>
        </div>`;
    });
    
    container.innerHTML = html;
    window.scrollTo(0, 0); // Scroll to top
}
        function closeSurah() {
            document.getElementById('surah-read-view').style.display = 'none';
            document.getElementById('surah-list-view').style.display = 'grid';
        }
        // --- QUICK SEARCH LOGIC ---
function quickSearch() {
    const city = document.getElementById('quick-city').value;
    const country = document.getElementById('quick-country').value;
    
    if(!city) {
        alert("Please enter a city name.");
        return;
    }

    // Reuse the existing loadPrayers function
    loadPrayers(city, country);
    
    // Optional: Also save this as the new default so it remembers it next time
    localStorage.setItem('city', city);
    localStorage.setItem('country', country);
}

// --- GREGORIAN DATE LOGIC ---
function updateGregorianDate() {
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const today = new Date().toLocaleDateString('en-US', options);
    document.getElementById('gregorian-date').innerText = today;
}

// Call the function immediately
updateGregorianDate();
// --- SMART COUNTDOWN (HANDLES RAMADAN SUHOOR/IFTAR) ---
let countdownInterval = null;

function startCountdown(timings) {
    const panel = document.getElementById('countdown-panel');
    if(panel) panel.style.display = 'block';
    
    if (countdownInterval) clearInterval(countdownInterval);

    const prayers = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
    
    countdownInterval = setInterval(() => {
        const now = new Date();
        const isRamadan = document.body.classList.contains('ramadan-mode');
        
        let targetDate = null;
        let labelText = "";
        let nextPrayerName = "Fajr"; // Default fallback

        // --- RAMADAN MODE LOGIC ---
        if (isRamadan) {
            // 1. Parse Fajr and Maghrib times
            const fajrTime = timings["Fajr"].replace(/\s*\(.*?\)\s*/g, "");
            const maghribTime = timings["Maghrib"].replace(/\s*\(.*?\)\s*/g, "");
            
            const fajrDate = new Date();
            const [fH, fM] = fajrTime.split(':');
            fajrDate.setHours(parseInt(fH), parseInt(fM), 0, 0);

            const maghribDate = new Date();
            const [mH, mM] = maghribTime.split(':');
            maghribDate.setHours(parseInt(mH), parseInt(mM), 0, 0);

            // 2. Decide what to show
            if (now < fajrDate) {
                // Before Fajr = Suhoor Time
                targetDate = fajrDate;
                labelText = "SUHOOR ENDS IN";
            } else if (now < maghribDate) {
                // Between Fajr and Maghrib = Fasting Time
                targetDate = maghribDate;
                labelText = "IFTAR IN";
            } else {
                // After Maghrib = Next Day's Suhoor
                targetDate = new Date();
                targetDate.setDate(now.getDate() + 1);
                targetDate.setHours(parseInt(fH), parseInt(fM), 0, 0);
                labelText = "SUHOOR ENDS IN";
            }

        } else {
            // --- NORMAL MODE LOGIC (Next Prayer) ---
            for (let name of prayers) {
                let timeStr = timings[name].replace(/\s*\(.*?\)\s*/g, ""); 
                const [hours, minutes] = timeStr.split(':');
                const pDate = new Date();
                pDate.setHours(parseInt(hours), parseInt(minutes), 0, 0);

                if (pDate > now) {
                    nextPrayerName = name;
                    targetDate = pDate;
                    break;
                }
            }
            // If passed Isha, next is Fajr tomorrow
            if (!targetDate) {
                nextPrayerName = "Fajr";
                let timeStr = timings["Fajr"].replace(/\s*\(.*?\)\s*/g, "");
                const [hours, minutes] = timeStr.split(':');
                targetDate = new Date();
                targetDate.setDate(targetDate.getDate() + 1);
                targetDate.setHours(parseInt(hours), parseInt(minutes), 0, 0);
            }
            labelText = `NEXT: ${nextPrayerName.toUpperCase()}`;
        }

        // --- CALCULATE & DISPLAY ---
        const diff = targetDate - now;
        const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const s = Math.floor((diff % (1000 * 60)) / 1000);

        const nameEl = document.getElementById('next-prayer-name');
        const timeEl = document.getElementById('time-remaining');

        if(nameEl) nameEl.innerText = labelText;
        if(timeEl) timeEl.innerText = `${h < 10 ? '0'+h : h}:${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;

    }, 1000);
}
// --- RAMADAN LOGIC ---
    const ramadanTips = [
        "Don't skip Suhoor; there is blessing in it.",
        "Break your fast with dates and water.",
        "Feed a fasting person to get their reward.",
        "Recite Quran more than usual this month.",
        "Make a specific Dua at the time of Iftar.",
        "Give charity daily, even if it's small.",
        "Pray Taraweeh to erase past sins."
    ];

    function toggleRamadanMode() {
        document.body.classList.toggle('ramadan-mode');
        const isActive = document.body.classList.contains('ramadan-mode');
        localStorage.setItem('ramadan', isActive);
        updateRamadanUI(isActive);
    }

    function updateRamadanUI(isActive) {
        const btn = document.getElementById('ramadan-toggle');
        const card = document.getElementById('ramadan-card');
        
        if (isActive) {
            btn.innerHTML = '<i class="fas fa-moon"></i> Ramadan Mode: ON';
            btn.classList.add('active');
            card.style.display = 'block'; // Show tracker
            
            // Load Counters
            document.getElementById('taraweeh-count').innerText = localStorage.getItem('cnt_taraweeh') || 0;
            document.getElementById('qada-count').innerText = localStorage.getItem('cnt_qada') || 0;
            
            // Load Random Tip
            document.getElementById('ramadan-tip').innerText = "Tip: " + ramadanTips[Math.floor(Math.random() * ramadanTips.length)];
        } else {
            btn.innerHTML = '<i class="fas fa-moon"></i> Ramadan Mode: OFF';
            btn.classList.remove('active');
            card.style.display = 'none'; // Hide tracker
        }
    }

    function modCount(key, val) {
        let current = parseInt(localStorage.getItem('cnt_' + key) || 0);
        current += val;
        if (current < 0) current = 0;
        localStorage.setItem('cnt_' + key, current);
        document.getElementById(key + '-count').innerText = current;
    }

    // Initialize Ramadan Mode on Load
    if (localStorage.getItem('ramadan') === 'true') {
        document.body.classList.add('ramadan-mode');
        updateRamadanUI(true);
    }
   /* --- OPTIMIZED DAILY VERSE (Saves for 24h) --- */
/* --- UPDATED AUDIO VERSE LOADER --- */
async function loadDailyVerse() {
    try {
        const id = Math.floor(Math.random() * 6236) + 1;
        
        // Fetch 3 Editions: Arabic Text, English Text, and Audio (Mishary Alafasy)
        const res = await fetch(`https://api.alquran.cloud/v1/ayah/${id}/editions/quran-uthmani,en.asad,ar.alafasy`);
        const d = await res.json();
        
        // 1. Set Texts
        document.getElementById('verse-ar').innerText = d.data[0].text;
        document.getElementById('verse-en').innerText = d.data[1].text;
        
        // 2. Set Reference
        const refText = `${d.data[0].surah.englishName} : ${d.data[0].numberInSurah}`;
        const refEl = document.getElementById('verse-ref');
        refEl.innerText = refText;
        
        // 3. Add Audio Player Button
        const audioUrl = d.data[2].audio;
        
        // Check if button already exists, remove it to prevent duplicates
        const oldBtn = document.getElementById('verse-play-btn');
        if(oldBtn) oldBtn.remove();

        // Create Audio Element
        const playerHTML = `
            <audio id="verse-player" src="${audioUrl}"></audio>
            <button id="verse-play-btn" onclick="document.getElementById('verse-player').play()" 
                style="display:block; margin:15px auto 0 auto; background:rgba(251, 191, 36, 0.15); border:1px solid var(--brand-gold); color:var(--brand-gold); padding:8px 25px; border-radius:50px; cursor:pointer; font-size:0.9rem; transition:0.3s;">
                <i class="fas fa-play"></i> Listen to Recitation
            </button>
        `;
        
        // Insert Player after reference
        refEl.insertAdjacentHTML('afterend', playerHTML);

    } catch(e){ 
        console.log("Verse load fail"); 
    }
}

// Helper to display the text
function renderVerse(data) {
    document.getElementById('verse-ar').innerText = data.ar;
    document.getElementById('verse-en').innerText = data.en;
    document.getElementById('verse-ref').innerText = data.ref;
}
// --- UPDATED: 1900+ HADITHS (Riyad as-Salihin) ---

// --- UPDATED: ROBUST HADITH LOADER ---

async function loadDailyHadith() {
    const container = document.getElementById('hadith-text');
    const ref = document.getElementById('hadith-ref');
    
    // Show loading state
    container.innerText = "Loading daily wisdom...";
    ref.innerText = "";

    // 1. Try fetching Riyad as-Salihin (Large collection)
    try {
        const res = await fetch('https://cdn.jsdelivr.net/gh/fawazahmed0/hadith-api@1/editions/eng-riyadussalihin.min.json');
        
        if (!res.ok) throw new Error("Network response was not ok");
        
        const data = await res.json();
        
        // Pick a random Hadith
        const random = data.hadiths[Math.floor(Math.random() * data.hadiths.length)];
        
        // Update display
        container.innerText = `"${random.text}"`;
        ref.innerText = `Riyad as-Salihin : Hadith ${random.hadithnumber}`;
        
    } catch(e) {
        console.warn("Primary Hadith source failed, switching to backup...", e);
        
        // 2. Fallback: Fetch 40 Hadith Nawawi (Smaller, more reliable)
        try {
            const resBackup = await fetch('https://cdn.jsdelivr.net/gh/fawazahmed0/hadith-api@1/editions/eng-nawawi.min.json');
            const dataBackup = await resBackup.json();
            const randomBackup = dataBackup.hadiths[Math.floor(Math.random() * dataBackup.hadiths.length)];
            
            container.innerText = `"${randomBackup.text}"`;
            ref.innerText = `40 Hadith Nawawi : Hadith ${randomBackup.hadithnumber}`;
            
        } catch(e2) {
            // 3. Ultimate Fallback (If no internet)
            container.innerText = "\"The best among you is the one who learns the Quran and teaches it.\"";
            ref.innerText = "Sahih Al-Bukhari";
        }
    }
}
loadDailyVerse();
loadDailyHadith();
// --- GPS LOCATION LOGIC ---
function getGPSLocation() {
    if (navigator.geolocation) {
        const btn = document.querySelector('button[onclick="getGPSLocation()"]');
        const originalText = btn.innerHTML;
        btn.innerText = "Locating...";
        
        navigator.geolocation.getCurrentPosition(
            async (position) => {
                const lat = position.coords.latitude;
                const long = position.coords.longitude;
                
                // Save coordinates for Qibla
                localStorage.setItem('lat', lat);
                localStorage.setItem('long', long);

                // Fetch City Name from coordinates (Reverse Geocoding)
                try {
                    const res = await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${long}&method=2`);
                    const data = await res.json();
                    
                    // The API returns meta data which might have timezone/location guess
                    // We will rely on the prayer times from lat/long directly
                    
                    // Update Settings Inputs just to show something (Optional)
                    document.getElementById('set-city').value = "GPS Location"; 
                    document.getElementById('set-country').value = "";

                    // Save and Reload
                    localStorage.setItem('city', "GPS Location"); 
                    localStorage.setItem('country', ""); 
                    
                    // Manually trigger the load with coordinates
                    loadPrayersByGPS(lat, long);
                    
                    alert("Location updated successfully!");
                    btn.innerHTML = originalText;
                    
                } catch(e) {
                    alert("Error fetching data.");
                    btn.innerHTML = originalText;
                }
            },
            (error) => {
                alert("GPS Error: " + error.message);
                btn.innerHTML = originalText;
            }
        );
    } else {
        alert("Geolocation is not supported by this browser.");
    }
}

// Helper to load by coordinates instead of city name
// --- FIXED: GPS LOCATION LOADER ---
async function loadPrayersByGPS(lat, long) {
    const container = document.getElementById('prayer-list-render');
    container.innerHTML = '<div class="spinner"></div>';
    
    try {
        const res = await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${long}&method=2`);
        if (!res.ok) throw new Error("Network error");

        const data = await res.json();
        const t = data.data.timings;
        
        document.getElementById('active-city-label').innerText = "Current Location";
        
        // *** REUSE THE SAME LOGIC ***
        updatePrayerUI(t, data.data.date.hijri);
        // ****************************

    } catch(e) {
        container.innerHTML = "Error loading GPS data.";
    }
}

// --- FIXED: INITIAL LOAD LOGIC ---
// This runs immediately when the page opens
const savedCity = localStorage.getItem('city');

if(savedCity && savedCity !== "GPS Location") {
    // Case 1: User has a saved city (e.g. "London")
    document.getElementById('set-city').value = savedCity;
    loadPrayers(savedCity, localStorage.getItem('country') || "");
} 
else if (localStorage.getItem('lat') && localStorage.getItem('long')) {
    // Case 2: User previously used GPS
    loadPrayersByGPS(localStorage.getItem('lat'), localStorage.getItem('long'));
} 
else {
    // Case 3: First time visitor (Load Makkah by default so it's not empty)
    loadPrayers("Makkah", "Saudi Arabia");
    document.getElementById('set-city').value = "Makkah";
}
// --- RAMADAN COUNTDOWN LOGIC ---
    function updateRamadanCountdown() {
        // Estimated Start: Feb 28, 2025
        // (Month is 0-indexed, so 1 = February)
        const ramadanStart = new Date(2026, 1, 17); 
        const now = new Date();
        
        const diff = ramadanStart - now;
        const daysLeft = Math.ceil(diff / (1000 * 60 * 60 * 24));
        
        const textEl = document.getElementById('ramadan-countdown-text');
        
        if (daysLeft > 0) {
            textEl.innerText = `${daysLeft} Days until Ramadan`;
        } else if (daysLeft > -30) {
            textEl.innerText = "Ramadan Mubarak!";
            textEl.style.color = "var(--brand-gold)";
        } else {
            textEl.innerText = ""; 
        }
    }

    // Call it immediately
    updateRamadanCountdown();

 // --- SERENITY TAB LOGIC (FIXED & VERIFIED) ---
    
    // Verified Embed-Friendly IDs (2025)
    const moods = {
        study: {
            // Zikrullah TV: Calm Lofi Recitation (Verified Working)
            id: "Cv4AnKiiB1s", 
            label: "Study Mode: Gentle Lofi Recitation"
        },
        sleep: {
            // Zikrullah TV: Deep Sleep & Protection
            id: "ymuOMJebI9I", 
            label: "Sleep Mode: Deep Tranquility"
        },
        nasheed: {
            // Vocals Only Ramadan Vibes (No Music)
            id: "0IvGeSRioAM", 
            label: "Relaxation: Soft Vocals (No Music)"
        },
        nature: {
            // Study With Anwar: Rain + Quran (Pomodoro Style)
            id: "dJ2hYHoO0Bw", 
            label: "Nature: Rain & Recitation"
        }
    };

    function playMood(mood, cardElement) {
        // 1. Highlight the selected card
        document.querySelectorAll('.mood-card').forEach(c => c.classList.remove('active'));
        if(cardElement) cardElement.classList.add('active');

        // 2. Update Player
        const player = document.getElementById('serenity-player');
        const label = document.getElementById('playing-label');
        const data = moods[mood];

        // 3. Construct URL (With strict origin policy fix)
        // We use 'embed' URL with specific parameters to prevent errors
        const src = `https://www.youtube.com/embed/${data.id}?autoplay=1&controls=1&modestbranding=1&rel=0&origin=${window.location.origin}`;

        player.src = src;
        label.innerText = data.label;
    }

    // Initialize with Study Mode
    setTimeout(() => {
        const firstCard = document.querySelector('.mood-card');
        if(firstCard) playMood('study', firstCard);
    }, 1000);

    // Simple Clock for Serenity Tab
    setInterval(() => {
        const clock = document.getElementById('serenity-clock');
        if(clock) {
            const now = new Date();
            clock.innerText = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }
    }, 1000);

    function updateVideoID() {
    const newID = prompt("Paste the new YouTube Video ID (e.g., dJ2hYHoO0Bw):");
    if(newID) {
        document.getElementById('serenity-player').src = `https://www.youtube.com/embed/${newID}?autoplay=1`;
    }
}
/* --- NEW FEATURES LOGIC --- */

// 1. Accessibility Logic (Text Size)
function changeFontSize(size) {
    const html = document.documentElement;
    html.classList.remove('font-large', 'font-extra');
    if (size === 'large') html.classList.add('font-large');
    if (size === 'extra') html.classList.add('font-extra');
    localStorage.setItem('userFontSize', size);
}
// Load saved size on startup
const savedSize = localStorage.getItem('userFontSize');
if (savedSize) changeFontSize(savedSize);

// 2. Heart Check-In Logic
/* --- EXPANDED HEART CHECK-IN LOGIC (50+ ENTRIES) --- */

const remedyDatabase = {
    anxious: [
        { title: "Sufficient is He", ar: "حَسْبُنَا اللَّهُ وَنِعْمَ الْوَكِيلُ", en: "Sufficient for us is Allah, and [He is] the best Disposer of affairs. (Quran 3:173)" },
        { title: "Find Peace", ar: "أَلَا بِذِكْرِ اللَّهِ تَطْمَئِنُّ الْقُلُوبُ", en: "Unquestionably, by the remembrance of Allah hearts are assured. (Quran 13:28)" },
        { title: "He Will Make a Way", ar: "وَمَن يَتَّقِ اللَّهَ يَجْعَل لَّهُ مَخْرَجًا", en: "And whoever fears Allah - He will make for him a way out. (Quran 65:2)" },
        { title: "Ease is Coming", ar: "فَإِنَّ مَعَ الْعُسْرِ يُسْرًا", en: "For indeed, with hardship [will be] ease. (Quran 94:5)" },
        { title: "Leave it to Him", ar: "وَأُفَوِّضُ أَمْرِي إِلَى اللَّهِ", en: "I entrust my affair to Allah. Indeed, Allah is Seeing of [His] servants. (Quran 40:44)" },
        { title: "He Knows", ar: "لَا تَخَافَا ۖ إِنَّنِي مَعَكُمَا أَسْمَعُ وَأَرَىٰ", en: "Do not fear. Indeed, I am with you both; I hear and I see. (Quran 20:46)" },
        { title: "The Ultimate Planner", ar: "وَيَمْكُرُونَ وَيَمْكُرُ اللَّهُ ۖ وَاللَّهُ خَيْرُ الْمَاكِرِينَ", en: "They plan, and Allah plans. And Allah is the best of planners. (Quran 8:30)" },
        { title: "Don't Carry the World", ar: "اللَّهُمَّ لَا تَجْعَلِ الدُّنْيَا أَكْبَرَ هَمِّنَا", en: "O Allah, do not make this world our greatest concern. (Tirmidhi)" },
        { title: "Seek Help", ar: "يَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ", en: "O Living, O Sustaining! In Your Mercy I seek relief! (Tirmidhi)" },
        { title: "Tie Your Camel", ar: "اعْقِلْهَا وَتَوَكَّلْ", en: "Tie your camel (do your part) and then trust in Allah. (Tirmidhi)" },
        { title: "Call Upon Him", ar: "أَمَّن يُجِيبُ الْمُضْطَرَّ إِذَا دَعَاهُ", en: "Is He [not best] who responds to the desperate one when he calls upon Him? (Quran 27:62)" },
        { title: "Nothing Can Harm You", ar: "بِسْمِ اللَّهِ الَّذِي لَا يَضُرُّ مَعَ اسْمِهِ شَيْءٌ", en: "In the Name of Allah, with Whose Name nothing is harmed on earth nor in heaven. (Abu Dawud)" },
        { title: "Tests are Love", ar: "إِذَا أَحَبَّ اللَّهُ قَوْمًا ابْتَلَاهُمْ", en: "When Allah loves a people, He tests them. (Tirmidhi)" },
        { title: "No Soul Burdened", ar: "لَا نُكَلِّفُ نَفْسًا إِلَّا وُسْعَهَا", en: "We do not impose on any soul a duty but to the extent of its ability. (Quran 23:62)" }
    ],
    sad: [
        { title: "Allah is With Us", ar: "لَا تَحْزَنْ إِنَّ اللَّهَ مَعَنَا", en: "Do not grieve; indeed Allah is with us. (Quran 9:40)" },
        { title: "He Will Satisfy You", ar: "وَلَسَوْفَ يُعْطِيكَ رَبُّكَ فَتَرْضَىٰ", en: "And your Lord is going to give you, and you will be satisfied. (Quran 93:5)" },
        { title: "Relief for the Soul", ar: "اللَّهُمَّ إِنِّي عَبْدُكَ... تَجْعَلَ الْقُرْآنَ رَبِيعَ قَلْبِي", en: "O Allah... make the Quran the spring of my heart and the remover of my sadness. (Ahmad)" },
        { title: "Patience is Beautiful", ar: "فَصَبْرٌ جَمِيلٌ ۖ وَاللَّهُ الْمُسْتَعَانُ", en: "So patience is most fitting. And Allah is the one sought for help. (Quran 12:18)" },
        { title: "Prophet's Grief Dua", ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْهَمِّ وَالْحَزَنِ", en: "O Allah, I seek refuge in You from anxiety and sorrow. (Bukhari)" },
        { title: "We Belong to Him", ar: "إِنَّا لِلَّهِ وَإِنَّا إِلَيْهِ رَاجِعُونَ", en: "Indeed we belong to Allah, and indeed to Him we will return. (Quran 2:156)" },
        { title: "Pain Erases Sins", ar: "مَا يُصِيبُ الْمُسْلِمَ مِنْ نَصَبٍ... إِلَّا كَفَّرَ اللَّهُ بِهَا مِنْ خَطَايَاهُ", en: "No fatigue, nor disease, nor sorrow, nor sadness... touches a Muslim but that Allah expiates some of his sins for it. (Bukhari)" },
        { title: "Complaint to Allah", ar: "إِنَّمَا أَشْكُو بَثِّي وَحُزْنِي إِلَى اللَّهِ", en: "I only complain of my suffering and my grief to Allah. (Quran 12:86)" },
        { title: "Light in Darkness", ar: "اللَّهُمَّ اجْعَلْ فِي قَلْبِي نُورًا", en: "O Allah, place light in my heart. (Muslim)" },
        { title: "The Comforter", ar: "يَا جَبَّارُ اجْبُرْنِي", en: "O Mender (of hearts), mend me. (Supplication)" },
        { title: "Peace Upon You", ar: "سَلَامٌ عَلَيْكُم بِمَا صَبَرْتُمْ", en: "Peace be upon you for what you patiently endured. And excellent is the final home. (Quran 13:24)" },
        { title: "He is Close", ar: "وَنَحْنُ أَقْرَبُ إِلَيْهِ مِنْ حَبْلِ الْوَرِيدِ", en: "And We are closer to him than [his] jugular vein. (Quran 50:16)" }
    ],
    lazy: [
        { title: "Seek Refuge", ar: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْعَجْزِ وَالْكَسَلِ", en: "O Allah, I seek refuge in You from incapacity and laziness. (Bukhari)" },
        { title: "Race to Forgiveness", ar: "وَسَارِعُوا إِلَىٰ مَغْفِرَةٍ مِّن رَّبِّكُمْ", en: "And hasten to forgiveness from your Lord and a garden as wide as the heavens and earth. (Quran 3:133)" },
        { title: "Just One Step", ar: "وَمَنْ أَتَانِي يَمْشِي أَتَيْتُهُ هَرْوَلَةً", en: "Whoever comes to Me walking, I will come to him running. (Hadith Qudsi)" },
        { title: "Be in this World", ar: "كُنْ فِي الدُّنْيَا كَأَنَّكَ غَرِيبٌ أَوْ عَابِرُ سَبِيلٍ", en: "Be in this world as if you were a stranger or a traveler. (Bukhari)" },
        { title: "Value Five", ar: "اغْتَنِمْ خَمْسًا قَبْلَ خَمْسٍ", en: "Take advantage of five before five: your youth before your old age... (Hakim)" },
        { title: "Help Me Worship", ar: "اللَّهُمَّ أَعِنِّي عَلَى ذِكْرِكَ وَشُكْرِكَ وَحُسْنِ عِبَادَتِكَ", en: "O Allah, help me to remember You, to give You thanks, and to perform Your worship in the best manner. (Abu Dawud)" },
        { title: "Morning Energy", ar: "أَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ لِلَّهِ", en: "We have entered the morning and the Kingdom belongs to Allah. (Muslim)" },
        { title: "Strive for Benefit", ar: "احْرِصْ عَلَى مَا يَنْفَعُكَ وَاسْتَعِنْ بِاللَّهِ", en: "Strive for that which will benefit you, and seek the help of Allah, and do not feel helpless. (Muslim)" },
        { title: "Strength is Loved", ar: "الْمُؤْمِنُ الْقَوِيُّ خَيْرٌ وَأَحَبُّ إِلَى اللَّهِ مِنَ الْمُؤْمِنِ الضَّعِيفِ", en: "The strong believer is better and more beloved to Allah than the weak believer. (Muslim)" },
        { title: "Consistency is Key", ar: "أَحَبُّ الأَعْمَالِ إِلَى اللَّهِ أَدْوَمُهَا وَإِنْ قَلَّ", en: "The most beloved deeds to Allah are those that are consistent, even if they are small. (Bukhari)" }
    ],
    grateful: [
        { title: "The Promise", ar: "لَئِن شَكَرْتُمْ لَأَزِيدَنَّكُمْ", en: "If you are grateful, I will surely increase you [in favor]. (Quran 14:7)" },
        { title: "Remember Me", ar: "فَاذْكُرُونِي أَذْكُرْكُمْ وَاشْكُرُوا لِي وَلَا تَكْفُرُونِ", en: "So remember Me; I will remember you. And be grateful to Me and do not deny Me. (Quran 2:152)" },
        { title: "Look Below You", ar: "انْظُرُوا إِلَى مَنْ هُوَ أَسْفَلَ مِنْكُمْ", en: "Look at those who are lower than you (financially/physically) but do not look at those who are higher... (Bukhari)" },
        { title: "Sujood of Thanks", ar: "سَجَدَ لِلَّهِ شُكْرًا", en: "Fall into prostration of thankfulness to Allah right now. (Sunnah)" },
        { title: "Best Dua", ar: "الْحَمْدُ لِلَّهِ", en: "Alhamdulillah (All Praise is due to Allah). It fills the scales. (Muslim)" },
        { title: "Praise for Guidance", ar: "الْحَمْدُ لِلَّهِ الَّذِي هَدَانَا لِهَٰذَا", en: "Praise to Allah, who has guided us to this. (Quran 7:43)" },
        { title: "Countless Favors", ar: "وَإِن تَعُدُّوا نِعْمَةَ اللَّهِ لَا تُحْصُوهَا", en: "And if you should count the favors of Allah, you could not enumerate them. (Quran 16:18)" },
        { title: "Better than the World", ar: "رَكْعَتَا الْفَجْرِ خَيْرٌ مِنَ الدُّنْيَا وَمَا فِيهَا", en: "The two rak'ahs (before) Fajr are better than the world and what is in it. (Muslim)" },
        { title: "Mercy is Better", ar: "هُوَ خَيْرٌ مِّمَّا يَجْمَعُونَ", en: "The Mercy of Allah is better than whatever wealth they accumulate. (Quran 10:58)" }
    ],
    sinful: [
        { title: "Do Not Despair", ar: "لَا تَقْنَطُوا مِن رَّحْمَةِ اللَّهِ", en: "Do not despair of the mercy of Allah. Indeed, Allah forgives all sins. (Quran 39:53)" },
        { title: "My Mercy Encompasses", ar: "وَرَحْمَتِي وَسِعَتْ كُلَّ شَيْءٍ", en: "My mercy encompasses all things. (Quran 7:156)" },
        { title: "Best of Sinners", ar: "كُلُّ بَنِي آدَمَ خَطَّاءٌ وَخَيْرُ الْخَطَّائِينَ التَّوَّابُونَ", en: "All the sons of Adam are sinners, but the best of sinners are those who repent often. (Tirmidhi)" },
        { title: "Sayyidul Istighfar", ar: "اللَّهُمَّ أَنْتَ رَبِّي لَا إِلَهَ إِلَّا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ", en: "O Allah, You are my Lord... forgive me, for no one forgives sins except You. (Bukhari)" },
        { title: "Replace with Good", ar: "إِنَّ الْحَسَنَاتِ يُذْهِبْنَ السَّيِّئَاتِ", en: "Indeed, good deeds do away with misdeeds. (Quran 11:114)" },
        { title: "Dua of Adam (as)", ar: "رَبَّنَا ظَلَمْنَا أَنفُسَنَا وَإِن لَّمْ تَغْفِرْ لَنَا...", en: "Our Lord, we have wronged ourselves, and if You do not forgive us... we will be losers. (Quran 7:23)" },
        { title: "Vast Forgiveness", ar: "يَا ابْنَ آدَمَ لَوْ بَلَغَتْ ذُنُوبُكَ عَنَانَ السَّمَاءِ ثُمَّ اسْتَغْفَرْتَنِي غَفَرْتُ لَكَ", en: "O son of Adam, were your sins to reach the clouds of the sky and were you then to ask forgiveness of Me, I would forgive you. (Hadith Qudsi)" },
        { title: "He Loves Repentance", ar: "إِنَّ اللَّهَ يُحِبُّ التَّوَّابِينَ", en: "Indeed, Allah loves those who are constantly repentant. (Quran 2:222)" },
        { title: "Angels Pray for You", ar: "وَيَسْتَغْفِرُونَ لِلَّذِينَ آمَنُوا", en: "And they (the angels) ask forgiveness for those who have believed. (Quran 40:7)" }
    ]
};
function showRemedy(mood) {
    document.getElementById('mood-selector').style.display = 'none';
    const box = document.getElementById('remedy-box');
    
    // 1. Get the list for this mood
    const list = remedyDatabase[mood];
    
    // 2. Pick a Random Item from the list
    const randomItem = list[Math.floor(Math.random() * list.length)];
    
    // 3. Update the UI
    document.getElementById('remedy-title').innerText = randomItem.title;
    document.getElementById('remedy-arabic').innerText = randomItem.ar;
    document.getElementById('remedy-translation').innerText = randomItem.en;
    
    box.style.display = 'block';
}

function resetMood() {
    document.getElementById('remedy-box').style.display = 'none';
    document.getElementById('mood-selector').style.display = 'flex';
}

// 3. Daily Checklist Logic
const sunnahs = [
    { id: 's1', text: "Prayed Fard Salah" },
    { id: 's2', text: "Read Quran" },
    { id: 's3', text: "Morning/Evening Adhkar" },
    { id: 's4', text: "Gave Charity (or smiled)" },
    { id: 's5', text: "Did Istighfar (100x)" }
];
function initChecklist() {
    const list = document.getElementById('sunnah-list');
    const today = new Date().toDateString();
    // Reset if it's a new day
    if (localStorage.getItem('checklist_date') !== today) {
        sunnahs.forEach(s => localStorage.removeItem(s.id));
        localStorage.setItem('checklist_date', today);
    }
    list.innerHTML = '';
    sunnahs.forEach(item => {
        const isChecked = localStorage.getItem(item.id) === 'true';
        const div = document.createElement('div');
        div.className = `check-item ${isChecked ? 'checked' : ''}`;
        div.onclick = () => {
            const checked = !div.classList.contains('checked');
            div.classList.toggle('checked');
            localStorage.setItem(item.id, checked);
            if(navigator.vibrate) navigator.vibrate(10);
        };
        div.innerHTML = `<div class="custom-checkbox"></div><span>${item.text}</span>`;
        list.appendChild(div);
    });
}
initChecklist();

// 4. Footer Actions
async function shareApp() {
    if (navigator.share) {
        try { await navigator.share({ title: 'Daily Deen', text: 'Free Prayer Times & Quran App. No Ads.', url: window.location.href }); } catch (err) {}
    } else {
        navigator.clipboard.writeText(window.location.href);
        const toast = document.getElementById('toast-box');
        toast.innerText = "Link copied! Share the rewards.";
        toast.style.display = "block";
        setTimeout(() => toast.style.display = "none", 3000);
    }
}
function bookmarkApp() {
    const toast = document.getElementById('toast-box');
    const isMac = navigator.userAgent.indexOf("Mac") !== -1;
    toast.innerText = isMac ? "Press Cmd + D to Bookmark" : "Press Ctrl + D to Bookmark";
    toast.style.display = "block";
    setTimeout(() => toast.style.display = "none", 4000);
}
function updateAtmosphere() {
        const date = new Date();
        const hour = date.getHours();
        const day = date.getDay(); // 5 = Friday
        const greetingEl = document.querySelector('.hero-dua');
        const body = document.body;
        const subheading = document.querySelector('.hero-tagline'); // We will use this too
        
        // 1. Reset Background Classes
        body.classList.remove('time-fajr', 'time-day', 'time-maghrib', 'time-night');
        
        let spiritualMsg = "";
        let subMsg = "Your Daily Companion"; // Default

        // 2. JUMMAH CHECK (Sunni Tradition)
        // If it is Thursday Night (after Maghrib) OR Friday before Maghrib
        const isJummah = (day === 4 && hour >= 18) || (day === 5 && hour < 18);

        if (isJummah) {
            spiritualMsg = "Jummah Mubarak. Illuminate your heart with Surah Al-Kahf.";
            subMsg = "Send abundant Salawat upon the Prophet ﷺ today.";
            // Keep the colors based on time, but maybe force a specific glow? 
            // Let's stick to time colors to keep it dynamic.
        } 
        
        // 3. Time Logic (Overrides message if NOT Jummah, or sets background)
        if (hour >= 4 && hour < 7) {
            body.classList.add('time-fajr');
            if(!isJummah) spiritualMsg = "The Lord descends to the lowest heaven. Ask, and you shall receive.";
        } else if (hour >= 7 && hour < 17) {
            body.classList.add('time-day');
            if(!isJummah) spiritualMsg = "Oh Allah, bless my early morning hours.";
        } else if (hour >= 17 && hour < 20) {
            body.classList.add('time-maghrib');
            if(!isJummah) spiritualMsg = "The sun sets, but the light of Allah never fades.";
        } else {
            body.classList.add('time-night');
            if(!isJummah) spiritualMsg = "Sleep with Wudu, and your soul prostrates under the Throne.";
        }

        // 4. Update Texts
        if(greetingEl && greetingEl.innerText !== `"${spiritualMsg}"`) {
            greetingEl.style.opacity = 0;
            setTimeout(() => {
                greetingEl.innerText = `"${spiritualMsg}"`;
                greetingEl.style.opacity = 1;
                // Also update the sub-header for special events
                if(subheading) subheading.innerText = subMsg;
            }, 500);
        }
    }

// Run on load and every minute
updateAtmosphere();
setInterval(updateAtmosphere, 60000);
/* --- ADHKAR DASHBOARD SYSTEM --- */

// 1. The Database
const dhikrData = [
    { id: 'subhan', cat: 'general', title: "SubhanAllah", ar: "سُبْحَانَ ٱللَّٰهِ", target: 33 },
    { id: 'alham', cat: 'general', title: "Alhamdulillah", ar: "ٱلْحَمْدُ لِلَّٰهِ", target: 33 },
    { id: 'allahu', cat: 'general', title: "Allahu Akbar", ar: "ٱللَّٰهُ أَكْبَرُ", target: 34 },
    { id: 'istighfar', cat: 'general', title: "Astaghfirullah", ar: "أَسْتَغْفِرُ ٱللَّٰهَ", target: 100 },
    { id: 'tahlil', cat: 'general', title: "La ilaha illallah", ar: "لَا إِلَٰهَ إِلَّا ٱللَّٰهُ", target: 100 },
    { id: 'salawat', cat: 'general', title: "Salawat (Durood)", ar: "اللَّهُمَّ صَلِّ عَلَى مُحَمَّدٍ", target: 10 },
    
    // Morning
    { id: 'm_kursi', cat: 'morning', title: "Ayatul Kursi", ar: "ٱللَّٰهُ لَا إِلَٰهَ إِلَّا هُوَ ٱلْحَيُّ ٱلْقَيُّومُ...", target: 1 },
    { id: 'm_ikhlas', cat: 'morning', title: "3 Quls (Ikhlas, Falaq, Nas)", ar: "قُلْ هُوَ ٱللَّٰهُ أَحَدٌ...", target: 3 },
    { id: 'm_subhan_bio', cat: 'morning', title: "SubhanAllahi wa bihamdihi", ar: "سُبْحَانَ اللَّهِ وَبِحَمْدِهِ", target: 100 },
    
    // Evening
    { id: 'e_kalimat', cat: 'evening', title: "Protection from Harm", ar: "أَعُوذُ بِكَلِمَاتِ اللَّهِ التَّامَّاتِ مِنْ شَرِّ مَا خَلَقَ", target: 3 },
    { id: 'e_radheetu', cat: 'evening', title: "Pleased with Allah", ar: "رَضِيتُ بِاللَّهِ رَبًّا وَبِالْإِسْلَامِ دِينًا وَبِمُحَمَّدٍ نَبِيًّا", target: 3 },
    
    // After Salah
    { id: 's_subhan', cat: 'salah', title: "SubhanAllah (Salah)", ar: "سُبْحَانَ ٱللَّٰهِ", target: 33 },
    { id: 's_alham', cat: 'salah', title: "Alhamdulillah (Salah)", ar: "ٱلْحَمْدُ لِلَّٰهِ", target: 33 },
    { id: 's_allahu', cat: 'salah', title: "Allahu Akbar (Salah)", ar: "ٱللَّٰهُ أَكْبَرُ", target: 33 },
    { id: 's_lailaha', cat: 'salah', title: "Final Dua", ar: "لَا إِلَهَ إِلَّا اللهُ وَحْدَهُ لَا شَرِيكَ لَهُ...", target: 1 }
];

let activeFilter = 'all';

// 2. Initialize Dashboard
function initAdhkarGrid() {
    renderAdhkar(activeFilter);
}

// 3. Render Cards
function renderAdhkar(filter) {
    const grid = document.getElementById('adhkar-grid');
    grid.innerHTML = '';
    
    dhikrData.forEach(item => {
        if (filter !== 'all' && item.cat !== filter) return;
        
        // Get Saved Count
        const current = parseInt(localStorage.getItem(`cnt_${item.id}`) || 0);
        const percent = Math.min((current / item.target) * 100, 100);
        const isDone = current >= item.target;

        const card = document.createElement('div');
        card.className = `dhikr-card ${isDone ? 'completed' : ''}`;
        card.style.setProperty('--progress', `${percent}%`);
        
        // Click to count (Tap anywhere on card)
        card.onclick = (e) => {
            // Don't count if clicking reset button
            if(e.target.closest('.reset-dhikr-btn')) return;
            incrementCard(item.id, item.target);
        };

        card.innerHTML = `
            <div class="dhikr-header">
                <div>
                    <div class="dhikr-title">${item.title}</div>
                    <div class="dhikr-cat-tag">${item.cat}</div>
                </div>
                <button class="reset-dhikr-btn" onclick="resetCard('${item.id}')">
                    <i class="fas fa-redo-alt" style="font-size:0.8rem;"></i>
                </button>
            </div>
            <div class="dhikr-arabic">${item.ar}</div>
            <div class="dhikr-controls">
                <div>
                    <span class="dhikr-count" id="count-${item.id}">${current}</span>
                    <span class="dhikr-target">/ ${item.target}</span>
                </div>
                ${isDone ? '<i class="fas fa-check-circle" style="color:var(--brand-green); font-size:1.5rem;"></i>' : ''}
            </div>
        `;
        grid.appendChild(card);
    });
}

// 4. Increment Logic
function incrementCard(id, target) {
    let current = parseInt(localStorage.getItem(`cnt_${id}`) || 0);
    
    // Loop behavior: If done, don't stop, just keep going or loop? 
    // Let's allow over-counting but vibrate on targets
    current++;
    
    localStorage.setItem(`cnt_${id}`, current);
    
    // Haptics
    if (navigator.vibrate) {
        if (current === target) navigator.vibrate([50, 50, 50]); // Done
        else navigator.vibrate(10); // Tap
    }
    
    // Re-render ONLY this card to keep performance high (Partial Update)
    // Actually, simple re-render of whole grid is fast enough for this size
    // But for animations, let's just update DOM elements if possible.
    // For simplicity in this snippets, re-render is safest.
    renderAdhkar(activeFilter);
}

// 5. Reset Logic
function resetCard(id) {
    if(confirm("Reset this counter?")) {
        localStorage.setItem(`cnt_${id}`, 0);
        renderAdhkar(activeFilter);
    }
}

// 6. Filter Logic
function filterAdhkar(cat, btn) {
    activeFilter = cat;
    
    // Update Buttons
    document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    
    renderAdhkar(cat);
}

// 7. Custom Dhikr (Simple Implementation)
function addCustomDhikr() {
    const title = prompt("Enter Name of Dhikr:");
    if(!title) return;
    const target = prompt("Enter Target Number:", "33");
    
    // Add to array (temporary for session) or create a persistent way
    // For now, let's push to the array and re-render
    dhikrData.push({
        id: 'custom_' + Date.now(),
        cat: 'general',
        title: title,
        ar: "Your Custom Dhikr",
        target: parseInt(target) || 33
    });
    renderAdhkar(activeFilter);
}

// Initialize
setTimeout(initAdhkarGrid, 100);
/* --- SCROLL INDICATOR LOGIC --- */

// 1. Function to scroll down smoothly
function scrollToGrid() {
    // Finds the heart check-in card or the grid
    const target = document.querySelector('.card'); 
    if(target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}

// 2. Auto-hide the indicator when user scrolls
window.addEventListener('scroll', () => {
    const indicator = document.querySelector('.scroll-indicator');
    if (!indicator) return;

    // If user scrolls down more than 50px, hide the button
    if (window.scrollY > 50) {
        indicator.classList.add('hidden');
    } else {
        indicator.classList.remove('hidden');
    }
});
/* --- FEEDBACK LOGIC (Connects to your Email) --- */

function openThankYouModal() {
    const input = document.getElementById('feedback-input');
    const text = input.value.trim();

    if (!text) {
        alert("Please write a small suggestion first!");
        return;
    }

    // 1. CHANGE THIS URL to your Formspree URL (Get it from Step 1)
    const FORMSPREE_URL = "https://formspree.io/f/mwvkakbr"; 

    // Change button text to show loading
    const btn = document.querySelector('.card button.btn-action');
    const originalText = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
    btn.disabled = true;

    // 2. Send Data to Formspree via 'fetch' (AJAX)
    fetch(FORMSPREE_URL, {
        method: 'POST',
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ 
            message: text,
            date: new Date().toLocaleDateString() + ' ' + new Date().toLocaleTimeString(),
            app_version: 'Daily Deen v1.0'
        })
    })
    .then(response => {
        if (response.ok) {
            // Success! Show the Thank You Modal
            input.value = ""; // Clear the box
            const modal = document.getElementById('thank-you-modal');
            modal.classList.add('show');
        } else {
            // Something went wrong
            alert("Oops! There was a problem sending your feedback.");
        }
    })
    .catch(error => {
        alert("Oops! There was a problem sending your feedback.");
    })
    .finally(() => {
        // Reset the button
        btn.innerHTML = originalText;
        btn.disabled = false;
    });
}

/* --- CORRECTED SEND LOGIC --- */
window.openThankYouModal = function() {
    const input = document.getElementById('feedback-input');
    const text = input ? input.value.trim() : "";

    // 1. VALIDATION CHECK
    // If text is empty, stop here and do not open the modal
    if (!text) {
        alert("Please write a suggestion first!");
        input.focus(); // Highlights the box so they know where to type
        return; 
    }

    // 2. SHOW LOADING STATE (Optional Visual Feedback)
    const btn = document.querySelector('.card button.btn-action'); // Finds the send button
    let originalText = "";
    
    if(btn) {
        originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
        btn.disabled = true; // Prevent double clicking
    }

    // 3. SIMULATE NETWORK DELAY (1 Second)
    setTimeout(() => {
        // Reset the button
        if(btn) {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }

        // Clear the input box (so they don't send the same thing twice)
        if(input) input.value = "";

        // NOW Open the Modal
        const modal = document.getElementById('thank-you-modal');
        if (modal) {
            modal.classList.add('show');
        }
    }, 1000); 
};
/* --- SAY AMEEN BUTTON LOGIC --- */
function sayAmeen(btn) {
    // 1. Visual Change
    btn.innerHTML = '<i class="fas fa-check"></i> Ameen';
    btn.style.background = 'var(--brand-gold)';
    btn.style.color = '#000';
    btn.style.boxShadow = '0 0 20px var(--brand-gold-glow)';
    btn.style.transform = 'scale(1.05)';
    btn.disabled = true; // Prevent multiple clicks

    // 2. Haptic Feedback (Mobile)
    if(navigator.vibrate) navigator.vibrate([50, 50, 50]);

    // 3. Show Thank You Message
    const msg = document.getElementById('ameen-count');
    msg.style.opacity = '1';
    msg.style.transform = 'translateY(-5px)';

    // 4. (Optional) You could actually save this count to a database later
    // For now, we save it locally so it stays "Clicked" for the user
    localStorage.setItem('ameen_clicked', 'true');
}

// Check if already clicked on load
if(localStorage.getItem('ameen_clicked') === 'true') {
    const btn = document.getElementById('ameen-btn');
    if(btn) {
        btn.innerHTML = '<i class="fas fa-check"></i> Ameen';
        btn.style.background = 'rgba(251, 191, 36, 0.2)'; // Softer gold for past click
        btn.style.color = 'var(--brand-gold)';
        btn.disabled = true;
    }
}
/* --- SAY AMEEN LOGIC (Global Fix) --- */
window.sayAmeen = function(btn) {
    // 1. Change the Button Look
    btn.innerHTML = '<i class="fas fa-check"></i> Ameen';
    btn.style.background = 'var(--brand-gold)';
    btn.style.color = '#000';
    btn.style.boxShadow = '0 0 20px var(--brand-gold-glow)';
    btn.style.transform = 'scale(1.05)';
    btn.disabled = true; // Stop double clicks

    // 2. Show the Thank You Message
    const msg = document.getElementById('ameen-msg');
    if(msg) {
        msg.style.opacity = '1';
        msg.style.transform = 'translateY(-5px)';
    }

    // 3. Vibrate on Mobile
    if(navigator.vibrate) navigator.vibrate([50, 50, 50]);

    // 4. Remember the click
    localStorage.setItem('ameen_clicked', 'true');
};

// Check on page load if they already clicked it
document.addEventListener('DOMContentLoaded', function() {
    if(localStorage.getItem('ameen_clicked') === 'true') {
        const btn = document.getElementById('ameen-btn');
        if(btn) {
            btn.innerHTML = '<i class="fas fa-check"></i> Ameen';
            btn.style.background = 'rgba(251, 191, 36, 0.2)'; 
            btn.style.color = 'var(--brand-gold)';
            btn.style.borderColor = 'transparent';
            btn.disabled = true;
        }
    }
});
/* --- INSTALL APP LOGIC --- */
let deferredPrompt;
const installBtn = document.getElementById('install-btn');

window.addEventListener('beforeinstallprompt', (e) => {
    // Prevent Chrome 67 and earlier from automatically showing the prompt
    e.preventDefault();
    // Stash the event so it can be triggered later.
    deferredPrompt = e;
    // Show the install button
    if(installBtn) installBtn.style.display = 'block';
});

if(installBtn) {
    installBtn.addEventListener('click', (e) => {
        // Hide the app provided install promotion
        installBtn.style.display = 'none';
        // Show the install prompt
        if(deferredPrompt) {
            deferredPrompt.prompt();
            // Wait for the user to respond to the prompt
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('User accepted the A2HS prompt');
                }
                deferredPrompt = null;
            });
        }
    });
}

/* --- CINEMATIC ANIMATION ENGINE --- */
document.addEventListener('DOMContentLoaded', () => {
    // 1. Activate Smooth Scroll (Lenis)
    const lenis = new Lenis({ duration: 1.2, easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)), smooth: true });
    function raf(time) { lenis.raf(time); requestAnimationFrame(raf); }
    requestAnimationFrame(raf);

    // 2. Activate Animations (GSAP)
    gsap.registerPlugin(ScrollTrigger);

    // Animate Header Text (Splits words)
    document.querySelectorAll('.hero-arabic, .greeting').forEach(text => {
        const type = new SplitType(text, { types: 'words, chars' });
        gsap.from(type.words, {
            scrollTrigger: { trigger: text, start: "top 90%" },
            y: '100%', opacity: 0, duration: 0.8, ease: "power3.out", stagger: 0.03
        });
    });

    // Animate Cards (Slide Up)
    const items = document.querySelectorAll('.card:not(.swipe-card), .horizontal-scroll');
    items.forEach((item) => {
        gsap.fromTo(item, 
            { y: 50, opacity: 0 },
            {
                scrollTrigger: { trigger: item, start: "top 90%" },
                y: 0, opacity: 1, duration: 0.8, ease: "power2.out"
            }
        );
    });
});

    </script>
    <script>
    // This runs independently to guarantee the screen clears
    window.onload = function() {
        setTimeout(function() {
            var screen = document.getElementById('bismillah-screen');
            if (screen) {
                screen.style.opacity = '0';
                setTimeout(function() { 
                    screen.style.display = 'none'; 
                }, 1500);
            }
        }, 1500); // Wait 1.5s then fade
    };
</script>
</body>
</html>
